{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"meshcore-bot Documentation","text":"<p>Documentation for the MeshCore bot: setup, configuration, commands, and services.</p> <p>New to the project? Start with Getting Started.</p>"},{"location":"#project-overview","title":"Project overview","text":"<ul> <li>README \u2013 Getting started, installation, quick start</li> <li>Command Reference \u2013 Full command reference</li> <li>Docker deployment \u2013 Docker deployment</li> <li>Service installation \u2013 Systemd service setup</li> <li>Web Viewer \u2013 Web viewer module</li> </ul>"},{"location":"#configuration","title":"Configuration","text":"Document Description Configuration config.ini structure and command options Path Command Path command presets and tuning Config validation Validate config.ini before starting the bot"},{"location":"#guides","title":"Guides","text":"Document Description Repeater Commands Repeater management DM commands Feed Management RSS/REST feeds and posting to channels Web Viewer Web-based data viewer and API"},{"location":"#service-plugins","title":"Service Plugins","text":"Document Description Service Plugins overview Enable and configure background services Discord Bridge One-way bridge to Discord Packet Capture Packet capture and MQTT Map Uploader Uploading to map.meshcore.dev Weather Service Scheduled weather and alerts"},{"location":"DOCKER/","title":"Docker Deployment Guide","text":"<p>This guide explains how to deploy meshcore-bot using Docker and Docker Compose.</p>"},{"location":"DOCKER/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker Engine 20.10+ or Docker Desktop</li> <li>Docker Compose 2.0+ (included with Docker Desktop)</li> </ul>"},{"location":"DOCKER/#quick-start","title":"Quick Start","text":"<ol> <li> <p>Clone the repository (if you haven't already):    <pre><code>git clone &lt;repository-url&gt;\ncd meshcore-bot\n</code></pre></p> </li> <li> <p>Run the setup script (recommended):    <pre><code>./docker-setup.sh\n</code></pre></p> </li> </ol> <p>This will create the necessary directories and copy the example config file.</p> <p>Or manually: <pre><code>mkdir -p data/{config,databases,logs,backups}\ncp config.ini.example data/config/config.ini\n</code></pre></p> <ol> <li> <p>Edit configuration file:    <pre><code># Edit data/config/config.ini with your settings\nnano data/config/config.ini  # or your preferred editor\n</code></pre></p> </li> <li> <p>Update database paths in config.ini:    The setup script (<code>./docker-setup.sh</code>) will automatically update these paths, but you can also set them manually:    <pre><code>[Bot]\ndb_path = /data/databases/meshcore_bot.db\n\n[Web_Viewer]\ndb_path = /data/databases/meshcore_bot.db\n\n[Logging]\nlog_file = /data/logs/meshcore_bot.log\n</code></pre></p> </li> </ol> <p>Important: The log file path must be absolute (<code>/data/logs/...</code>), not relative. Relative paths will resolve to the config directory which is read-only.</p> <ol> <li> <p>Start the container:    <pre><code>docker-compose up -d\n</code></pre></p> </li> <li> <p>View logs:    <pre><code>docker-compose logs -f\n</code></pre></p> </li> </ol>"},{"location":"DOCKER/#configuration","title":"Configuration","text":""},{"location":"DOCKER/#volume-mappings","title":"Volume Mappings","text":"<p>The <code>docker-compose.yml</code> file maps the following directories:</p> <ul> <li><code>./data/config</code> \u2192 <code>/data/config</code> (read-only) - Configuration files</li> <li><code>./data/databases</code> \u2192 <code>/data/databases</code> - SQLite database files</li> <li><code>./data/logs</code> \u2192 <code>/data/logs</code> - Log files</li> <li><code>./data/backups</code> \u2192 <code>/data/backups</code> - Database backups</li> </ul>"},{"location":"DOCKER/#serial-port-access","title":"Serial Port Access","text":"<p>\u26a0\ufe0f Important: Docker Desktop on macOS does NOT support serial device passthrough.</p> <p>If you're using a serial connection, you have several options:</p> <p>Option 1: Use TCP Connection (Recommended for macOS) If your MeshCore device supports TCP/IP (via gateway or bridge), configure it in <code>config.ini</code>: <pre><code>[Connection]\nconnection_type = tcp\nhostname = 192.168.1.60  # Your device's IP or hostname\ntcp_port = 5000\n</code></pre> Then comment out or remove the <code>devices</code> section in <code>docker-compose.yml</code>.</p> <p>Option 2: Serial-to-TCP Bridge (macOS workaround) Use a tool like <code>socat</code> to bridge the serial port to TCP on the host: <pre><code># On macOS host, create TCP bridge\nsocat TCP-LISTEN:5000,reuseaddr,fork FILE:/dev/cu.usbmodem1101,raw,nonblock,waitlock=/var/run/socat.pid\n</code></pre> Then configure the bot to use TCP connection to <code>localhost:5000</code>.</p> <p>Option 3: Device Mapping (Linux only) On Linux, you can map the serial device directly: <pre><code>devices:\n  - /dev/ttyUSB0:/dev/ttyUSB0\n</code></pre></p> <p>Option 4: Host Network Mode (Linux only, for BLE) For BLE connections on Linux, you may need host network access: <pre><code>network_mode: host\n</code></pre> Note: Host network mode gives the container full access to the host network, which has security implications.</p>"},{"location":"DOCKER/#web-viewer-port","title":"Web Viewer Port","text":"<p>If you enable the web viewer, uncomment and adjust the <code>ports</code> section: <pre><code>ports:\n  - \"8080:8080\"\n</code></pre></p> <p>Make sure your <code>config.ini</code> has: <pre><code>[Web_Viewer]\nenabled = true\nhost = 0.0.0.0  # Required for Docker port mapping\nport = 8080\n</code></pre></p>"},{"location":"DOCKER/#building-the-image","title":"Building the Image","text":""},{"location":"DOCKER/#using-docker-compose","title":"Using Docker Compose","text":"<p>Important: To avoid pull warnings, build the image first: <pre><code>docker compose build\n</code></pre></p> <p>Then start the container: <pre><code>docker compose up -d\n</code></pre></p> <p>Or build and start in one command: <pre><code>docker compose up -d --build\n</code></pre></p> <p>The <code>--build</code> flag ensures the image is built locally rather than attempting to pull from a registry.</p>"},{"location":"DOCKER/#using-docker-directly","title":"Using Docker directly","text":"<pre><code>docker build -t meshcore-bot:latest .\n</code></pre>"},{"location":"DOCKER/#running-the-container","title":"Running the Container","text":""},{"location":"DOCKER/#start-in-background","title":"Start in background","text":"<pre><code>docker-compose up -d\n</code></pre>"},{"location":"DOCKER/#start-in-foreground-see-logs","title":"Start in foreground (see logs)","text":"<pre><code>docker-compose up\n</code></pre>"},{"location":"DOCKER/#stop-the-container","title":"Stop the container","text":"<pre><code>docker-compose down\n</code></pre>"},{"location":"DOCKER/#restart-the-container","title":"Restart the container","text":"<pre><code>docker-compose restart\n</code></pre>"},{"location":"DOCKER/#managing-the-container","title":"Managing the Container","text":""},{"location":"DOCKER/#view-logs","title":"View logs","text":"<pre><code># Follow logs\ndocker-compose logs -f\n\n# Last 100 lines\ndocker-compose logs --tail=100\n\n# Logs for specific service\ndocker-compose logs meshcore-bot\n</code></pre>"},{"location":"DOCKER/#execute-commands-in-container","title":"Execute commands in container","text":"<pre><code>docker-compose exec meshcore-bot bash\n</code></pre>"},{"location":"DOCKER/#update-the-container","title":"Update the container","text":"<pre><code># Pull latest changes\ngit pull\n\n# Rebuild and restart\ndocker-compose up -d --build\n</code></pre>"},{"location":"DOCKER/#using-pre-built-images","title":"Using Pre-built Images","text":"<p>If you're using GitHub Container Registry images:</p> <ol> <li> <p>Update docker-compose.yml to use the image:    <pre><code>services:\n  meshcore-bot:\n    image: ghcr.io/your-username/meshcore-bot:latest\n    # Remove or comment out the 'build' section\n</code></pre></p> </li> <li> <p>Pull and start:    <pre><code>docker-compose pull\ndocker-compose up -d\n</code></pre></p> </li> </ol>"},{"location":"DOCKER/#troubleshooting","title":"Troubleshooting","text":""},{"location":"DOCKER/#permission-issues","title":"Permission Issues","text":"<p>If you encounter permission issues with database or log files:</p> <ol> <li> <p>Check file ownership:    <pre><code>ls -la data/databases/\nls -la data/logs/\n</code></pre></p> </li> <li> <p>Fix permissions (if needed):    <pre><code>sudo chown -R 1000:1000 data/\n</code></pre></p> </li> </ol> <p>The container runs as user ID 1000 (meshcore user).</p>"},{"location":"DOCKER/#serial-port-permission-denied","title":"Serial Port Permission Denied","text":"<p>If you see <code>[Errno 13] Permission denied</code> when accessing serial devices:</p> <ol> <li> <p>Check device permissions (on host):    <pre><code>ls -l /dev/ttyUSB0  # or /dev/ttyACM0\n# Should show: crw-rw---- 1 root dialout ...\n</code></pre></p> </li> <li> <p>Ensure device has dialout group (on host):    <pre><code># Check current group\nls -l /dev/ttyUSB0 | awk '{print $4}'\n\n# If not dialout, fix it (temporary - will reset on reboot)\nsudo chmod 666 /dev/ttyUSB0\n\n# Or make it permanent with udev rules:\nsudo nano /etc/udev/rules.d/99-serial-permissions.rules\n# Add: KERNEL==\"ttyUSB[0-9]*\", MODE=\"0666\", GROUP=\"dialout\"\n# Then: sudo udevadm control --reload-rules\n</code></pre></p> </li> <li> <p>Rebuild the container (to ensure user is in dialout group):    <pre><code>docker compose build\ndocker compose up -d\n</code></pre></p> </li> <li> <p>Alternative: Use privileged mode (less secure, but works):    <pre><code># In docker-compose.override.yml\nservices:\n  meshcore-bot:\n    privileged: true\n</code></pre></p> </li> </ol>"},{"location":"DOCKER/#serial-port-not-found","title":"Serial Port Not Found","text":"<ol> <li> <p>Check device exists:    <pre><code>ls -l /dev/ttyUSB0  # or your device\n</code></pre></p> </li> <li> <p>Use host network mode if device mapping doesn't work:    <pre><code>network_mode: host\n</code></pre></p> </li> </ol>"},{"location":"DOCKER/#database-locked-errors","title":"Database Locked Errors","text":"<p>If you see database locked errors:</p> <ol> <li> <p>Stop the container:    <pre><code>docker-compose down\n</code></pre></p> </li> <li> <p>Check for leftover database files:    <pre><code>ls -la data/databases/*.db-*\n</code></pre></p> </li> <li> <p>Remove lock files (if safe):    <pre><code>rm data/databases/*.db-shm data/databases/*.db-wal\n</code></pre></p> </li> <li> <p>Restart:    <pre><code>docker-compose up -d\n</code></pre></p> </li> </ol>"},{"location":"DOCKER/#container-wont-start","title":"Container Won't Start","text":"<ol> <li> <p>Check logs:    <pre><code>docker-compose logs\n</code></pre></p> </li> <li> <p>Verify config file exists:    <pre><code>ls -la data/config/config.ini\n</code></pre></p> </li> <li> <p>Test config file syntax:    <pre><code>docker-compose run --rm meshcore-bot python3 -c \"import configparser; c = configparser.ConfigParser(); c.read('/data/config/config.ini'); print('Config OK')\"\n</code></pre></p> </li> </ol>"},{"location":"DOCKER/#build-failures-on-arm-devices-orange-pi-raspberry-pi-etc","title":"Build Failures on ARM Devices (Orange Pi, Raspberry Pi, etc.)","text":"<p>If you encounter network errors during build like: <pre><code>failed to add the host (veth...) &lt;=&gt; sandbox (veth...) pair interfaces: operation not supported\n</code></pre></p> <p>Try these solutions:</p> <ol> <li> <p>Restart Docker daemon:    <pre><code>sudo systemctl restart docker\n</code></pre></p> </li> <li> <p>Check kernel modules are loaded:    <pre><code>lsmod | grep bridge\nlsmod | grep veth\n</code></pre>    If missing, load them:    <pre><code>sudo modprobe bridge\nsudo modprobe veth\n</code></pre></p> </li> <li> <p>Build directly with docker build (bypasses compose networking - RECOMMENDED):    <pre><code># Build the image directly\nDOCKER_BUILDKIT=0 docker build -t meshcore-bot:latest .\n\n# Then use docker compose normally (it will use the existing image)\ndocker compose up -d\n</code></pre>    This bypasses Docker Compose's networking setup during build, which often fails on ARM devices.</p> </li> <li> <p>Use host network mode for build (alternative):    <pre><code>DOCKER_BUILDKIT=0 docker build --network=host -t meshcore-bot:latest .\ndocker compose up -d\n</code></pre></p> </li> <li> <p>Check Docker bridge configuration:    <pre><code>sudo brctl show\n</code></pre>    If bridge doesn't exist, Docker may need to be reconfigured.</p> </li> <li> <p>Check Docker daemon logs:    <pre><code>sudo journalctl -u docker -n 50\n</code></pre></p> </li> <li> <p>Reinstall Docker (if other solutions fail):    <pre><code># Backup your data first!\nsudo apt-get remove docker docker-engine docker.io containerd runc\n# Then reinstall Docker following Armbian/Docker official instructions\n</code></pre></p> </li> </ol>"},{"location":"DOCKER/#production-deployment","title":"Production Deployment","text":"<p>For production deployments:</p> <ol> <li> <p>Use specific image tags instead of <code>latest</code>:    <pre><code>image: ghcr.io/your-username/meshcore-bot:v1.0.0\n</code></pre></p> </li> <li> <p>Set resource limits in <code>docker-compose.yml</code>:    <pre><code>deploy:\n  resources:\n    limits:\n      cpus: '1.0'\n      memory: 512M\n    reservations:\n      cpus: '0.5'\n      memory: 256M\n</code></pre></p> </li> <li> <p>Use secrets management for sensitive configuration:</p> </li> <li>Use Docker secrets (Docker Swarm)</li> <li>Use environment variables for API keys</li> <li> <p>Mount secret files as read-only volumes</p> </li> <li> <p>Enable log rotation (already configured in docker-compose.yml):    <pre><code>logging:\n  driver: \"json-file\"\n  options:\n    max-size: \"10m\"\n    max-file: \"3\"\n</code></pre></p> </li> <li> <p>Set up health checks (already included in Dockerfile):    The container includes a basic health check. Monitor with:    <pre><code>docker-compose ps\n</code></pre></p> </li> </ol>"},{"location":"DOCKER/#backup-and-restore","title":"Backup and Restore","text":""},{"location":"DOCKER/#backup","title":"Backup","text":"<pre><code># Backup databases\ndocker-compose exec meshcore-bot tar czf /data/backups/backup-$(date +%Y%m%d).tar.gz /data/databases\n\n# Or from host\ntar czf backups/backup-$(date +%Y%m%d).tar.gz data/databases/\n</code></pre>"},{"location":"DOCKER/#restore","title":"Restore","text":"<pre><code># Stop container\ndocker-compose down\n\n# Restore databases\ntar xzf backups/backup-YYYYMMDD.tar.gz -C data/\n\n# Start container\ndocker-compose up -d\n</code></pre>"},{"location":"DOCKER/#security-considerations","title":"Security Considerations","text":"<ol> <li> <p>Non-root user: The container runs as a non-root user (UID 1000)</p> </li> <li> <p>Read-only config: Config directory is mounted read-only to prevent accidental modifications</p> </li> <li> <p>Network isolation: By default, containers are isolated. Only expose ports you need</p> </li> <li> <p>Secrets: Never commit API keys or sensitive data to version control. Use environment variables or secrets management</p> </li> <li> <p>Web viewer: If enabled, ensure it's only accessible on trusted networks or use a reverse proxy with authentication</p> </li> </ol>"},{"location":"DOCKER/#additional-resources","title":"Additional Resources","text":"<ul> <li>Docker Documentation</li> <li>Docker Compose Documentation</li> <li>Main README for general bot configuration.</li> </ul>"},{"location":"FEEDS/","title":"Feed Management","text":"<p>The Feed Management system allows the bot to subscribe to RSS feeds and REST APIs, automatically polling for new content and posting updates to specified mesh channels.</p>"},{"location":"FEEDS/#overview","title":"Overview","text":"<p>The feed manager supports two feed types: - RSS Feeds: Standard RSS/Atom feeds - API Feeds: REST API endpoints returning JSON data</p> <p>Both feed types support: - Configurable polling intervals - Custom message formatting - Item filtering - Sorting - Automatic deduplication - Rate limiting</p>"},{"location":"FEEDS/#configuration","title":"Configuration","text":""},{"location":"FEEDS/#global-settings","title":"Global Settings","text":"<p>Configure feed manager behavior in <code>config.ini</code>:</p> <pre><code>[Feed_Manager]\n# Enable/disable feed manager\nfeed_manager_enabled = true\n\n# Default check interval (seconds)\ndefault_check_interval_seconds = 300\n\n# Maximum items to process per check\nmax_items_per_check = 10\n\n# HTTP request timeout (seconds)\nfeed_request_timeout = 30\n\n# User agent for HTTP requests\nfeed_user_agent = MeshCoreBot/1.0 FeedManager\n\n# Rate limit between requests to same domain (seconds)\nfeed_rate_limit_seconds = 5.0\n\n# Maximum message length (characters)\nmax_message_length = 130\n\n# Default output format\ndefault_output_format = {emoji} {body|truncate:100} - {date}\\n{link|truncate:50}\n\n# Default interval between sending queued messages (seconds)\ndefault_message_send_interval_seconds = 2.0\n</code></pre>"},{"location":"FEEDS/#rss-feed-configuration","title":"RSS Feed Configuration","text":"<p>The web interface provides separate input fields for each configuration option. Below are examples showing the values to enter in each field.</p>"},{"location":"FEEDS/#basic-rss-feed","title":"Basic RSS Feed","text":"<p>Feed Type: <code>rss</code> Feed URL: <code>https://example.com/rss.xml</code> Channel: <code>#alerts</code> Feed Name (Optional): <code>Example RSS Feed</code> Check Interval (seconds): <code>300</code> Output Format: (leave empty to use default) Message Send Interval (seconds): <code>2.0</code> Filter Configuration: (leave empty) Sort Configuration: (leave empty)</p>"},{"location":"FEEDS/#rss-feed-with-custom-format","title":"RSS Feed with Custom Format","text":"<p>Feed Type: <code>rss</code> Feed URL: <code>https://example.com/rss.xml</code> Channel: <code>#alerts</code> Feed Name (Optional): <code>Emergency Alerts</code> Check Interval (seconds): <code>60</code> Output Format: <pre><code>{emoji} {title|truncate:80}\n{body|truncate:100}\n{date}\n</code></pre> Message Send Interval (seconds): <code>2.0</code> Filter Configuration: (leave empty) Sort Configuration: (leave empty)</p>"},{"location":"FEEDS/#api-feed-configuration","title":"API Feed Configuration","text":""},{"location":"FEEDS/#basic-api-feed","title":"Basic API Feed","text":"<p>Feed Type: <code>api</code> Feed URL: <code>https://api.example.com/alerts</code> Channel: <code>#alerts</code> Feed Name (Optional): <code>API Alerts</code> Check Interval (seconds): <code>300</code> Output Format: (leave empty to use default) Message Send Interval (seconds): <code>2.0</code> API Configuration (JSON): <pre><code>{\n  \"method\": \"GET\",\n  \"headers\": {},\n  \"params\": {\n    \"api_key\": \"your-api-key\"\n  },\n  \"response_parser\": {\n    \"items_path\": \"data.alerts\",\n    \"id_field\": \"id\",\n    \"title_field\": \"title\",\n    \"description_field\": \"description\",\n    \"timestamp_field\": \"created_at\"\n  }\n}\n</code></pre> Filter Configuration: (leave empty) Sort Configuration: (leave empty)</p>"},{"location":"FEEDS/#wsdot-highway-alerts-example","title":"WSDOT Highway Alerts Example","text":"<p>Feed Type: <code>api</code> Feed URL: <code>https://wsdot.wa.gov/Traffic/api/HighwayAlerts/HighwayAlertsREST.svc/GetAlertsAsJson</code> Channel: <code>#traffic</code> Feed Name (Optional): <code>WSDOT Highway Alerts</code> Check Interval (seconds): <code>300</code> Output Format: <pre><code>{emoji} [{raw.Priority|switch:highest:\ud83d\udd34:high:\ud83d\udfe0:medium:\ud83d\udfe1:\u26aa}] {title|truncate:80}\n{raw.EventCategory} | {raw.Region} | {raw.EventStatus}\n{body|truncate:70}\n</code></pre> Message Send Interval (seconds): <code>2.0</code> API Configuration (JSON): <pre><code>{\n  \"method\": \"GET\",\n  \"headers\": {},\n  \"params\": {\n    \"AccessCode\": \"your-access-code\"\n  },\n  \"response_parser\": {\n    \"items_path\": \"\",\n    \"id_field\": \"AlertID\",\n    \"title_field\": \"HeadlineDescription\",\n    \"description_field\": \"ExtendedDescription\",\n    \"timestamp_field\": \"LastUpdatedTime\"\n  }\n}\n</code></pre> Filter Configuration (JSON): <pre><code>{\n  \"conditions\": [\n    {\n      \"field\": \"raw.EventCategory\",\n      \"operator\": \"in\",\n      \"values\": [\"Alert\", \"Closure\"]\n    }\n  ],\n  \"logic\": \"OR\"\n}\n</code></pre> Sort Configuration (JSON): <pre><code>{\n  \"field\": \"raw.LastUpdatedTime\",\n  \"order\": \"desc\"\n}\n</code></pre></p>"},{"location":"FEEDS/#output-format","title":"Output Format","text":"<p>The output format string controls how feed items are formatted before sending to channels.</p>"},{"location":"FEEDS/#placeholders","title":"Placeholders","text":"<ul> <li><code>{title}</code> - Item title</li> <li><code>{body}</code> - Item description/body text</li> <li><code>{date}</code> - Relative time (e.g., \"5m ago\", \"2h 30m ago\")</li> <li><code>{link}</code> - Item URL</li> <li><code>{emoji}</code> - Auto-selected emoji based on feed name (\ud83d\udce2, \ud83d\udea8, \u26a0\ufe0f, \u2139\ufe0f)</li> <li><code>{raw.field}</code> - Access raw API data fields (API feeds only)</li> <li><code>{raw.nested.field}</code> - Access nested API fields (e.g., <code>{raw.StartRoadwayLocation.RoadName}</code>)</li> </ul>"},{"location":"FEEDS/#shortening-functions","title":"Shortening Functions","text":"<p>Apply functions to placeholders using the pipe operator:</p> <ul> <li><code>{field|truncate:N}</code> - Truncate to N characters</li> <li><code>{field|word_wrap:N}</code> - Wrap at N characters, breaking at word boundaries</li> <li><code>{field|first_words:N}</code> - Take first N words</li> </ul> <p>Examples: <pre><code>{title|truncate:60}\n{body|word_wrap:100}\n{body|first_words:20}\n</code></pre></p>"},{"location":"FEEDS/#regex-extraction","title":"Regex Extraction","text":"<p>Extract specific content using regex patterns:</p> <ul> <li><code>{field|regex:pattern}</code> - Extract using regex (uses first capture group)</li> <li><code>{field|regex:pattern:group}</code> - Extract specific capture group (0 = whole match, 1 = first group, etc.)</li> </ul> <p>Examples: <pre><code>{body|regex:Temperature:\\s*([^\\n]+):1}\n{body|regex:Conditions:\\s*([^\\n]+):1}\n</code></pre></p>"},{"location":"FEEDS/#conditional-formatting","title":"Conditional Formatting","text":"<ul> <li><code>{field|if_regex:pattern:then:else}</code> - If pattern matches, return \"then\", else return \"else\"</li> <li><code>{field|switch:value1:result1:value2:result2:...:default}</code> - Multi-value conditional</li> </ul> <p>Examples: <pre><code>{raw.Priority|switch:highest:\ud83d\udd34:high:\ud83d\udfe0:medium:\ud83d\udfe1:\u26aa}\n{body|if_regex:No restrictions:\ud83d\udc4d:Restrictions apply}\n</code></pre></p>"},{"location":"FEEDS/#extract-and-check","title":"Extract and Check","text":"<ul> <li><code>{field|regex_cond:extract_pattern:check_pattern:then:group}</code> - Extract text, check if it matches pattern, return \"then\" if match, else return extracted text</li> </ul> <p>Example: <pre><code>{body|regex_cond:Northbound\\s*\\n([^\\n]+):No restrictions:\ud83d\udc4d:1}\n</code></pre></p>"},{"location":"FEEDS/#filter-configuration","title":"Filter Configuration","text":"<p>Filter configuration determines which items are sent to channels.</p>"},{"location":"FEEDS/#filter-structure","title":"Filter Structure","text":"<pre><code>{\n  \"conditions\": [\n    {\n      \"field\": \"raw.Priority\",\n      \"operator\": \"in\",\n      \"values\": [\"highest\", \"high\"]\n    },\n    {\n      \"field\": \"raw.EventStatus\",\n      \"operator\": \"equals\",\n      \"value\": \"open\"\n    }\n  ],\n  \"logic\": \"AND\"\n}\n</code></pre>"},{"location":"FEEDS/#operators","title":"Operators","text":"<ul> <li><code>equals</code> - Exact match</li> <li><code>not_equals</code> - Not equal</li> <li><code>in</code> - Value in list</li> <li><code>not_in</code> - Value not in list</li> <li><code>matches</code> - Regex match</li> <li><code>not_matches</code> - Regex does not match</li> <li><code>contains</code> - String contains value</li> <li><code>not_contains</code> - String does not contain value</li> </ul>"},{"location":"FEEDS/#logic","title":"Logic","text":"<ul> <li><code>AND</code> - All conditions must match (default)</li> <li><code>OR</code> - Any condition matches</li> </ul>"},{"location":"FEEDS/#field-paths","title":"Field Paths","text":"<p>For API feeds, use <code>raw.field</code> or <code>raw.nested.field</code> to access API response fields: - <code>raw.Priority</code> - <code>raw.EventStatus</code> - <code>raw.StartRoadwayLocation.RoadName</code></p>"},{"location":"FEEDS/#sort-configuration","title":"Sort Configuration","text":"<p>Sort items before processing:</p> <pre><code>{\n  \"field\": \"raw.LastUpdatedTime\",\n  \"order\": \"desc\"\n}\n</code></pre>"},{"location":"FEEDS/#sort-options","title":"Sort Options","text":"<ul> <li><code>field</code> - Field path to sort by (e.g., <code>raw.LastUpdatedTime</code>, <code>raw.Priority</code>, <code>published</code>)</li> <li><code>order</code> - <code>asc</code> (ascending) or <code>desc</code> (descending)</li> </ul>"},{"location":"FEEDS/#date-format-support","title":"Date Format Support","text":"<p>The sort function supports: - ISO format dates - Microsoft JSON date format: <code>/Date(timestamp-offset)/</code> (e.g., WSDOT API) - Unix timestamps - Common date string formats</p>"},{"location":"FEEDS/#message-queuing","title":"Message Queuing","text":"<p>Messages are queued and sent at configured intervals to prevent rate limiting:</p> <ul> <li><code>message_send_interval_seconds</code> - Time between sending messages from the same feed (default: 2.0 seconds)</li> <li>Messages are automatically queued and processed in order</li> <li>Each feed maintains its own send interval</li> </ul>"},{"location":"FEEDS/#deduplication","title":"Deduplication","text":"<p>The system automatically prevents duplicate posts:</p> <ul> <li>Items are tracked by ID in the database</li> <li>Previously processed items are skipped</li> <li>Works correctly even when sorting changes item order</li> <li>Database-backed deduplication ensures reliability across restarts</li> </ul>"},{"location":"FEEDS/#rate-limiting","title":"Rate Limiting","text":"<p>The feed manager implements rate limiting:</p> <ul> <li>Per-domain rate limiting (default: 5 seconds between requests to same domain)</li> <li>Configurable via <code>feed_rate_limit_seconds</code></li> <li>Prevents overwhelming feed sources</li> </ul>"},{"location":"FEEDS/#web-interface","title":"Web Interface","text":"<p>The feed management system includes a web interface accessible at <code>/feeds</code>:</p> <ul> <li>View all feed subscriptions</li> <li>Add/edit/delete feeds</li> <li>Preview output format with live feed data</li> <li>View feed statistics and activity</li> <li>Monitor errors</li> </ul>"},{"location":"FEEDS/#command-interface","title":"Command Interface","text":"<p>Feeds can be managed via mesh commands. The feed command requires admin access and must be sent as a direct message (DM) to the bot. The command is enabled by default.</p> <p>Command Format: <code>feed &lt;subcommand&gt; [arguments]</code> (DM only)</p>"},{"location":"FEEDS/#available-commands","title":"Available Commands","text":"<ul> <li><code>feed subscribe &lt;rss|api&gt; &lt;url&gt; &lt;channel&gt; [name] [api_config]</code> - Subscribe to a feed</li> <li><code>feed unsubscribe &lt;id|url&gt; [channel]</code> - Unsubscribe from a feed (by ID or URL)</li> <li><code>feed list [channel]</code> - List all feed subscriptions (optionally filtered by channel)</li> <li><code>feed status &lt;id&gt;</code> - Show detailed status for a feed</li> <li><code>feed enable &lt;id&gt;</code> - Enable a feed subscription</li> <li><code>feed disable &lt;id&gt;</code> - Disable a feed subscription</li> <li><code>feed update &lt;id&gt; [interval_seconds]</code> - Update feed settings</li> <li><code>feed test &lt;url&gt;</code> - Test/validate a feed URL</li> </ul>"},{"location":"FEEDS/#examples","title":"Examples","text":"<pre><code>feed subscribe rss https://alerts.example.com/rss emergency \"Emergency Alerts\"\nfeed subscribe api https://api.example.com/alerts emergency \"API Alerts\" '{\"headers\": {\"Authorization\": \"Bearer TOKEN\"}}'\nfeed list\nfeed list #alerts\nfeed status 1\nfeed enable 1\nfeed disable 1\nfeed unsubscribe 1\nfeed update 1 60\n</code></pre> <p>Note: The feed command requires admin access. API feeds require JSON configuration as the last argument when subscribing.</p>"},{"location":"FEEDS/#best-practices","title":"Best Practices","text":"<ol> <li> <p>Check Intervals: Set appropriate intervals based on feed update frequency (60-300 seconds typical)</p> </li> <li> <p>Message Formatting: Keep messages under 130 characters for mesh compatibility</p> </li> <li> <p>Filtering: Use filters to reduce noise and only send relevant items</p> </li> <li> <p>Rate Limiting: Respect feed source rate limits by configuring appropriate intervals</p> </li> <li> <p>Error Handling: Monitor feed errors in the web interface and adjust configuration as needed</p> </li> <li> <p>Testing: Use the preview feature in the web interface to test output formats before enabling feeds</p> </li> </ol>"},{"location":"FEEDS/#troubleshooting","title":"Troubleshooting","text":""},{"location":"FEEDS/#feeds-not-polling","title":"Feeds Not Polling","text":"<ul> <li>Verify <code>feed_manager_enabled = true</code> in config</li> <li>Check that feeds are enabled in the database</li> <li>Review bot logs for errors</li> <li>Ensure bot is connected to mesh network</li> </ul>"},{"location":"FEEDS/#items-not-appearing","title":"Items Not Appearing","text":"<ul> <li>Check filter configuration - items may be filtered out</li> <li>Verify output format is correct</li> <li>Check feed activity log in web interface</li> <li>Review error log for parsing issues</li> </ul>"},{"location":"FEEDS/#duplicate-messages","title":"Duplicate Messages","text":"<ul> <li>Deduplication is automatic - check if item IDs are changing</li> <li>Verify <code>last_item_id</code> is being updated correctly</li> <li>Check database for processed items</li> </ul>"},{"location":"FEEDS/#rate-limiting-issues","title":"Rate Limiting Issues","text":"<ul> <li>Increase <code>feed_rate_limit_seconds</code> in config</li> <li>Increase <code>message_send_interval_seconds</code> for specific feeds</li> <li>Reduce <code>check_interval_seconds</code> to poll less frequently</li> </ul>"},{"location":"SERVICE-INSTALLATION/","title":"MeshCore Bot Service Installation","text":"<p>This guide explains how to install the MeshCore Bot as a systemd service on Linux systems.</p>"},{"location":"SERVICE-INSTALLATION/#prerequisites","title":"Prerequisites","text":"<ul> <li>Linux system with systemd</li> <li>Python 3.7+</li> <li>Root/sudo access</li> <li>MeshCore-compatible device</li> </ul>"},{"location":"SERVICE-INSTALLATION/#quick-installation","title":"Quick Installation","text":"<ol> <li> <p>Clone and navigate to the bot directory: <pre><code>git clone &lt;repository-url&gt;\ncd meshcore-bot\n</code></pre></p> </li> <li> <p>Run the installation script: <pre><code>sudo ./install-service.sh\n</code></pre></p> </li> <li> <p>Configure the bot: <pre><code>sudo nano /opt/meshcore-bot/config.ini\n</code></pre></p> </li> <li> <p>Start the service: <pre><code>sudo systemctl start meshcore-bot\n</code></pre></p> </li> <li> <p>Check status: <pre><code>sudo systemctl status meshcore-bot\n</code></pre></p> </li> </ol>"},{"location":"SERVICE-INSTALLATION/#manual-installation","title":"Manual Installation","text":"<p>If you prefer to install manually:</p>"},{"location":"SERVICE-INSTALLATION/#1-create-service-user","title":"1. Create Service User","text":"<pre><code>sudo useradd --system --no-create-home --shell /bin/false meshcore\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#2-create-directories","title":"2. Create Directories","text":"<pre><code>sudo mkdir -p /opt/meshcore-bot\nsudo mkdir -p /var/log/meshcore-bot\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#3-copy-bot-files","title":"3. Copy Bot Files","text":"<pre><code>sudo cp -r . /opt/meshcore-bot/\nsudo chown -R meshcore:meshcore /opt/meshcore-bot\nsudo chown -R meshcore:meshcore /var/log/meshcore-bot\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#4-install-service-file","title":"4. Install Service File","text":"<pre><code>sudo cp meshcore-bot.service /etc/systemd/system/\nsudo systemctl daemon-reload\nsudo systemctl enable meshcore-bot\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#5-install-dependencies","title":"5. Install Dependencies","text":"<pre><code>sudo pip3 install -r /opt/meshcore-bot/requirements.txt\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#service-management","title":"Service Management","text":""},{"location":"SERVICE-INSTALLATION/#startstoprestart","title":"Start/Stop/Restart","text":"<pre><code>sudo systemctl start meshcore-bot\nsudo systemctl stop meshcore-bot\nsudo systemctl restart meshcore-bot\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#check-status","title":"Check Status","text":"<pre><code>sudo systemctl status meshcore-bot\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#view-logs","title":"View Logs","text":"<pre><code># Real-time logs\nsudo journalctl -u meshcore-bot -f\n\n# Recent logs\nsudo journalctl -u meshcore-bot -n 100\n\n# Logs since boot\nsudo journalctl -u meshcore-bot -b\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#enabledisable-auto-start","title":"Enable/Disable Auto-start","text":"<pre><code>sudo systemctl enable meshcore-bot    # Start on boot\nsudo systemctl disable meshcore-bot   # Don't start on boot\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#configuration","title":"Configuration","text":"<p>The bot configuration is located at <code>/opt/meshcore-bot/config.ini</code>. Edit it with:</p> <pre><code>sudo nano /opt/meshcore-bot/config.ini\n</code></pre> <p>After changing configuration, restart the service:</p> <pre><code>sudo systemctl restart meshcore-bot\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#service-features","title":"Service Features","text":""},{"location":"SERVICE-INSTALLATION/#security","title":"Security","text":"<ul> <li>Runs as dedicated <code>meshcore</code> user</li> <li>No shell access for service user</li> <li>Restricted file system access</li> <li>Resource limits (512MB RAM, 50% CPU)</li> </ul>"},{"location":"SERVICE-INSTALLATION/#reliability","title":"Reliability","text":"<ul> <li>Automatic restart on failure</li> <li>Restart delay of 10 seconds</li> <li>Maximum 3 restart attempts per minute</li> <li>Logs to systemd journal</li> </ul>"},{"location":"SERVICE-INSTALLATION/#monitoring","title":"Monitoring","text":"<ul> <li>Systemd journal integration</li> <li>Status monitoring via systemctl</li> <li>Resource usage tracking</li> </ul>"},{"location":"SERVICE-INSTALLATION/#troubleshooting","title":"Troubleshooting","text":""},{"location":"SERVICE-INSTALLATION/#service-wont-start","title":"Service Won't Start","text":"<ol> <li>Check service status: <code>sudo systemctl status meshcore-bot</code></li> <li>View logs: <code>sudo journalctl -u meshcore-bot -n 50</code></li> <li>Check configuration: <code>sudo nano /opt/meshcore-bot/config.ini</code></li> <li>Verify dependencies: <code>sudo pip3 list | grep meshcore</code></li> </ol>"},{"location":"SERVICE-INSTALLATION/#permission-issues","title":"Permission Issues","text":"<ol> <li>Check file ownership: <code>ls -la /opt/meshcore-bot/</code></li> <li>Fix permissions: <code>sudo chown -R meshcore:meshcore /opt/meshcore-bot</code></li> </ol>"},{"location":"SERVICE-INSTALLATION/#connection-issues","title":"Connection Issues","text":"<ol> <li>Verify device connection (serial port, BLE, etc.)</li> <li>Check device permissions for service user</li> <li>Review connection settings in config.ini</li> </ol>"},{"location":"SERVICE-INSTALLATION/#high-resource-usage","title":"High Resource Usage","text":"<p>The service has built-in limits: - Memory: 512MB maximum - CPU: 50% maximum - File descriptors: 65536 maximum</p>"},{"location":"SERVICE-INSTALLATION/#uninstallation","title":"Uninstallation","text":"<p>To completely remove the service:</p> <pre><code>sudo ./uninstall-service.sh\n</code></pre> <p>This will: - Stop and disable the service - Remove systemd service file - Remove installation directory - Remove log directory - Remove service user</p>"},{"location":"SERVICE-INSTALLATION/#file-locations","title":"File Locations","text":"Component Location Service file <code>/etc/systemd/system/meshcore-bot.service</code> Bot files <code>/opt/meshcore-bot/</code> Configuration <code>/opt/meshcore-bot/config.ini</code> Logs <code>/var/log/meshcore-bot/</code> (if configured) System logs <code>journalctl -u meshcore-bot</code>"},{"location":"SERVICE-INSTALLATION/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"SERVICE-INSTALLATION/#custom-installation-directory","title":"Custom Installation Directory","text":"<p>Edit the service file to change the installation directory:</p> <pre><code>sudo nano /etc/systemd/system/meshcore-bot.service\n</code></pre> <p>Change the <code>WorkingDirectory</code> and <code>ExecStart</code> paths.</p>"},{"location":"SERVICE-INSTALLATION/#custom-user","title":"Custom User","text":"<p>To use a different user, edit the service file and update the installation script.</p>"},{"location":"SERVICE-INSTALLATION/#environment-variables","title":"Environment Variables","text":"<p>Add environment variables to the service file:</p> <pre><code>[Service]\nEnvironment=PYTHONPATH=/opt/meshcore-bot\nEnvironment=DEBUG=true\nEnvironment=CUSTOM_VAR=value\n</code></pre>"},{"location":"SERVICE-INSTALLATION/#support","title":"Support","text":"<p>For issues with the service installation: 1. Check the logs: <code>sudo journalctl -u meshcore-bot -f</code> 2. Verify configuration: <code>sudo nano /opt/meshcore-bot/config.ini</code> 3. Test manually: <code>sudo -u meshcore python3 /opt/meshcore-bot/meshcore_bot.py</code></p>"},{"location":"command-reference-website/","title":"Custom command reference website","text":"<p>Use the <code>generate_website.py</code> script to build a single-page HTML command reference from your <code>config.ini</code>. The output lists your enabled commands, keywords, usage, and channel restrictions so you can host it on your own site for users.</p>"},{"location":"command-reference-website/#basic-usage","title":"Basic usage","text":"<pre><code>python generate_website.py [config.ini]\n</code></pre> <p>This reads your config (default: <code>config.ini</code>), loads your commands and channels, and writes <code>website/index.html</code> in the same directory as the config file. Upload that file (and the directory if you use assets) to your web host.</p>"},{"location":"command-reference-website/#choose-a-style","title":"Choose a style","text":"<p>The <code>--style</code> option selects a theme (colors, typography, layout). Default is <code>default</code> (modern dark). To see all themes:</p> <pre><code>python generate_website.py --list-styles\n</code></pre> <p>Then generate with a specific style:</p> <pre><code>python generate_website.py config.ini --style minimalist\npython generate_website.py config.ini --style terminal\n</code></pre> <p>Available styles include: default (modern dark), minimalist (light, clean), terminal (green/amber on black), glass (glassmorphism), neon (cyberpunk), brutalist (bold, high contrast), gradient (colorful gradients), pixel (retro gaming). Run <code>--list-styles</code> for the full list and short descriptions.</p>"},{"location":"command-reference-website/#preview-all-styles","title":"Preview all styles","text":"<p>To generate a sample page for every style plus an index that links to them (useful to pick a theme):</p> <pre><code>python generate_website.py config.ini --sample\n</code></pre> <p>Output goes to <code>website/</code> with one HTML file per style and an <code>index.html</code> you can open locally.</p>"},{"location":"command-reference-website/#custom-title-and-intro","title":"Custom title and intro","text":"<p>Optional <code>[Website]</code> section in <code>config.ini</code>:</p> <pre><code>[Website]\nwebsite_title = My Mesh Bot - Commands\nintroduction_text = Welcome! Here are the commands you can use on the mesh.\n</code></pre> <p>If omitted, the script uses the bot name and a default intro.</p>"},{"location":"command-reference-website/#uploading","title":"Uploading","text":"<p>The script produces a self-contained HTML file (with embedded CSS). Upload <code>website/index.html</code> to any static host (e.g. GitHub Pages, Netlify, or your group's web server). No server-side processing is required.</p>"},{"location":"command-reference/","title":"MeshCore Bot Commands","text":"<p>This document provides a comprehensive list of all available commands in the MeshCore Bot, with examples and detailed explanations.</p>"},{"location":"command-reference/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Basic Commands</li> <li>Information Commands</li> <li>Emergency Commands</li> <li>Gaming Commands</li> <li>Entertainment Commands</li> <li>Sports Commands</li> <li>MeshCore Utility Commands</li> <li>Admin Commands</li> </ul>"},{"location":"command-reference/#basic-commands","title":"Basic Commands","text":""},{"location":"command-reference/#test-or-t","title":"<code>test</code> or <code>t</code>","text":"<p>Test message response to verify bot connectivity and functionality.</p> <p>Usage: - <code>test</code> - Basic test response - <code>test &lt;phrase&gt;</code> - Test with optional phrase</p> <p>Examples: <pre><code>test\nt hello world\n</code></pre></p> <p>Response: Confirms message receipt with connection information.</p>"},{"location":"command-reference/#ping","title":"<code>ping</code>","text":"<p>Simple ping/pong response to test bot responsiveness.</p> <p>Usage: <pre><code>ping\n</code></pre></p> <p>Response: <code>Pong!</code></p>"},{"location":"command-reference/#help","title":"<code>help</code>","text":"<p>Show available commands or get detailed help for a specific command.</p> <p>Usage: - <code>help</code> - List all available commands - <code>help &lt;command&gt;</code> - Get detailed help for a specific command</p> <p>Examples: <pre><code>help\nhelp wx\nhelp repeater\n</code></pre></p> <p>Response: Lists commands or provides detailed information about the specified command.</p>"},{"location":"command-reference/#hello","title":"<code>hello</code>","text":"<p>Greeting response. Also responds to various greeting keywords.</p> <p>Usage: <pre><code>hello\nhi\nhey\nhowdy\ngreetings\n</code></pre></p> <p>Response: Friendly greeting message.</p>"},{"location":"command-reference/#cmd","title":"<code>cmd</code>","text":"<p>List available commands in compact format.</p> <p>Usage: <pre><code>cmd\n</code></pre></p> <p>Response: Compact list of all available commands.</p>"},{"location":"command-reference/#information-commands","title":"Information Commands","text":""},{"location":"command-reference/#channels","title":"<code>channels</code>","text":"<p>List and manage hashtag channels on the MeshCore network.</p> <p>Usage: - <code>channels</code> - List general channels - <code>channels list</code> - List all channel categories - <code>channels &lt;category&gt;</code> - List channels in a specific category - <code>channels #channel</code> - Get information about a specific channel</p> <p>Examples: <pre><code>channels\nchannels list\nchannels emergency\nchannels #general\n</code></pre></p> <p>Response: Lists available channels with their descriptions and usage statistics.</p>"},{"location":"command-reference/#wx-zipcode","title":"<code>wx &lt;zipcode&gt;</code>","text":"<p>Get weather information for a US zip code using NOAA data.</p> <p>Aliases: <code>weather</code>, <code>wxa</code>, <code>wxalert</code></p> <p>Usage: <pre><code>wx &lt;zipcode&gt;\nweather &lt;zipcode&gt;\nwxa &lt;zipcode&gt;\nwxalert &lt;zipcode&gt;\n</code></pre></p> <p>Examples: <pre><code>wx 98101\nweather 90210\nwxa 10001\n</code></pre></p> <p>Response: Current weather conditions, forecast for tonight/tomorrow, and active weather alerts. Includes: - Current conditions (temperature, humidity, wind, etc.) - Short-term forecast (tonight, tomorrow) - Weather alerts if any are active</p> <p>Note: Weather alerts are automatically included when available.</p>"},{"location":"command-reference/#gwx-location","title":"<code>gwx &lt;location&gt;</code>","text":"<p>Get global weather information for any location worldwide using Open-Meteo API.</p> <p>Aliases: <code>globalweather</code>, <code>gwxa</code></p> <p>Usage: <pre><code>gwx &lt;location&gt;\nglobalweather &lt;location&gt;\ngwxa &lt;location&gt;\n</code></pre></p> <p>Examples: <pre><code>gwx Tokyo\ngwx Paris, France\ngwx London\nglobalweather New York\ngwx 35.6762,139.6503\n</code></pre></p> <p>Response: Current weather conditions and forecast for the specified location, including: - Current temperature and conditions - Feels-like temperature - Wind speed and direction - Humidity - Dew point - Visibility - Pressure - Forecast for today/tonight and tomorrow</p>"},{"location":"command-reference/#aqi-location","title":"<code>aqi &lt;location&gt;</code>","text":"<p>Get Air Quality Index (AQI) information for a location.</p> <p>Usage: <pre><code>aqi &lt;location&gt;\naqi &lt;city&gt;\naqi &lt;city&gt;, &lt;state&gt;\naqi &lt;city&gt;, &lt;country&gt;\naqi &lt;latitude&gt;,&lt;longitude&gt;\naqi help\n</code></pre></p> <p>Examples: <pre><code>aqi seattle\naqi greenwood\naqi vancouver canada\naqi 47.6,-122.3\naqi help\n</code></pre></p> <p>Response: Air quality data including: - US AQI value and category - European AQI (if available) - Pollutant concentrations (PM2.5, PM10, Ozone, etc.) - Health recommendations</p>"},{"location":"command-reference/#airplanes-location-options-overhead-latlon","title":"<code>airplanes [location] [options]</code> / <code>overhead [lat,lon]</code>","text":"<p>Get aircraft tracking information using ADS-B data from airplanes.live or compatible APIs.</p> <p>Aliases: <code>aircraft</code>, <code>planes</code>, <code>adsb</code>, <code>overhead</code></p> <p>Usage: <pre><code>airplanes\nairplanes here\nairplanes &lt;latitude&gt;,&lt;longitude&gt;\nairplanes [location] [options]\noverhead\noverhead &lt;latitude&gt;,&lt;longitude&gt;\n</code></pre></p> <p>Special Command: <code>overhead</code> - Returns the single closest aircraft directly overhead - Uses companion location from database (if available) - If companion location not available, prompts user to specify coordinates - Always returns one aircraft sorted by distance (closest first)</p> <p>Location Options: - No location: Uses companion location (if available), otherwise bot location - <code>here</code>: Uses bot location from config - <code>&lt;lat&gt;,&lt;lon&gt;</code>: Uses specified coordinates (e.g., <code>47.6,-122.3</code>)</p> <p>Filter Options: - <code>radius=&lt;nm&gt;</code> - Search radius in nautical miles (default: 25, max: 250) - <code>alt=&lt;min&gt;-&lt;max&gt;</code> - Filter by altitude range in feet (e.g., <code>alt=1000-5000</code>) - <code>speed=&lt;min&gt;-&lt;max&gt;</code> - Filter by ground speed range in knots - <code>type=&lt;code&gt;</code> - Filter by aircraft type code (e.g., <code>B738</code>, <code>A321</code>) - <code>callsign=&lt;pattern&gt;</code> - Filter by callsign pattern - <code>military</code> - Show only military aircraft - <code>ladd</code> - Show only LADD aircraft - <code>pia</code> - Show only PIA aircraft - <code>squawk=&lt;code&gt;</code> - Filter by transponder squawk code - <code>limit=&lt;n&gt;</code> - Limit number of results (default: 10, max: 50) - <code>closest</code> - Sort by distance (closest first) - <code>highest</code> - Sort by altitude (highest first) - <code>fastest</code> - Sort by speed (fastest first)</p> <p>Examples: <pre><code>airplanes\nairplanes here\nairplanes 47.6,-122.3\nairplanes radius=50\nairplanes alt=10000-40000\nairplanes type=B738\nairplanes military\nairplanes callsign=UAL limit=5\nairplanes 47.6,-122.3 radius=25 closest\n</code></pre></p> <p>Response: - Single aircraft: Detailed format with callsign, type, altitude, speed, track, distance, bearing, vertical rate, and registration - Multiple aircraft: Compact list format with callsign, altitude, speed, distance, and bearing</p> <p>Configuration: The command can be configured in <code>config.ini</code> under <code>[Airplanes_Command]</code>: - <code>enabled</code> - Enable/disable the command - <code>api_url</code> - API endpoint URL (default: <code>http://api.airplanes.live/v2/</code>) - <code>default_radius</code> - Default search radius in nautical miles - <code>max_results</code> - Maximum number of results to return - <code>url_timeout</code> - API request timeout in seconds</p> <p>Note: Uses companion location from database if available, otherwise falls back to bot location from config. The API is rate-limited to 1 request per second.</p>"},{"location":"command-reference/#sun","title":"<code>sun</code>","text":"<p>Get sunrise and sunset times for the bot's configured location.</p> <p>Usage: <pre><code>sun\n</code></pre></p> <p>Response: Sunrise and sunset times, day length, and solar noon.</p> <p>Note: Uses the bot's configured default location (<code>bot_latitude</code> and <code>bot_longitude</code> in config.ini), not the user's location from their advert.</p>"},{"location":"command-reference/#moon","title":"<code>moon</code>","text":"<p>Get moon phase information and moonrise/moonset times for the bot's configured location.</p> <p>Usage: <pre><code>moon\n</code></pre></p> <p>Response: Current moon phase, moonrise/moonset times, and illumination percentage.</p> <p>Note: Uses the bot's configured default location (<code>bot_latitude</code> and <code>bot_longitude</code> in config.ini), not the user's location from their advert.</p>"},{"location":"command-reference/#solar","title":"<code>solar</code>","text":"<p>Get solar conditions and HF band status.</p> <p>Usage: <pre><code>solar\n</code></pre></p> <p>Response: Solar activity information including: - Solar flux - Sunspot number - A-index and K-index - HF band conditions (Open/Closed/Marginal) - Solar activity summary</p>"},{"location":"command-reference/#solarforecast-or-sf","title":"<code>solarforecast</code> or <code>sf</code>","text":"<p>Get solar panel production forecast for a location.</p> <p>Usage: <pre><code>sf &lt;location|repeater_name|coordinates|zipcode&gt; [panel_size] [azimuth] [angle]\nsolarforecast &lt;location&gt; [panel_size] [azimuth] [angle]\n</code></pre></p> <p>Parameters: - <code>location</code> - Location name, repeater name, coordinates (lat,lon), or zipcode - <code>panel_size</code> - Panel size in watts (optional, default: 100W) - <code>azimuth</code> - Panel azimuth in degrees, 0=south (optional, default: 180) - <code>angle</code> - Panel tilt angle in degrees (optional, default: 30)</p> <p>Examples: <pre><code>sf seattle\nsf seattle 200\nsf seattle 200 180 45\nsf 47.6,-122.3 150\nsf repeater1 100 180 30\n</code></pre></p> <p>Response: Solar panel production forecast including: - Daily production estimate - Hourly production breakdown - Peak production time - Total daily kWh estimate</p>"},{"location":"command-reference/#hfcond","title":"<code>hfcond</code>","text":"<p>Get HF band conditions for amateur radio.</p> <p>Usage: <pre><code>hfcond\n</code></pre></p> <p>Response: HF band conditions including: - Band status (Open/Closed/Marginal) - Solar flux - A-index and K-index - Propagation conditions</p>"},{"location":"command-reference/#satpass-norad","title":"<code>satpass &lt;NORAD&gt;</code>","text":"<p>Get satellite pass information for a satellite by NORAD ID.</p> <p>Usage: - <code>satpass &lt;NORAD&gt;</code> - Get radio passes (all passes above horizon) - <code>satpass &lt;NORAD&gt; visual</code> - Get visual passes only (must be visually observable) - <code>satpass &lt;shortcut&gt;</code> - Use predefined shortcuts</p> <p>Shortcuts: - Weather Satellites: <code>noaa15</code>, <code>noaa18</code>, <code>noaa19</code>, <code>metop-a</code>, <code>metop-b</code>, <code>metop-c</code>, <code>goes16</code>, <code>goes17</code>, <code>goes18</code> - Space Stations: <code>iss</code>, <code>tiangong</code>, <code>tiangong1</code>, <code>tiangong2</code> - Telescopes: <code>hst</code>, <code>hubble</code> - Other: <code>starlink</code></p> <p>Examples: <pre><code>satpass 25544\nsatpass iss\nsatpass iss visual\nsatpass noaa19\nsatpass hubble visual\n</code></pre></p> <p>Response: Upcoming satellite passes including: - Pass start/end times - Maximum elevation - Duration - Azimuth at start/end - Visual pass indicator (if applicable)</p> <p>Note: Requires <code>n2yo_api_key</code> to be configured in <code>config.ini</code>.</p>"},{"location":"command-reference/#emergency-commands","title":"Emergency Commands","text":""},{"location":"command-reference/#alert-location-all","title":"<code>alert &lt;location&gt; [all]</code>","text":"<p>Get active emergency incidents for a location.</p> <p>Usage: <pre><code>alert &lt;city|zipcode|street city|lat,lon|county&gt; [all]\n</code></pre></p> <p>Parameters: - <code>location</code> - City name, zipcode, street address with city, coordinates, or county name - <code>all</code> - Show all incidents (default: shows most relevant incidents)</p> <p>Examples: <pre><code>alert seattle\nalert 98101\nalert main street seattle\nalert 47.6,-122.3\nalert seattle all\nalert king county\n</code></pre></p> <p>Response: Active emergency incidents including: - Incident type and description - Location - Agency - Time - Severity level</p> <p>Note: Requires <code>Alert_Command</code> configuration in <code>config.ini</code> with agency IDs for your area.</p>"},{"location":"command-reference/#gaming-commands","title":"Gaming Commands","text":""},{"location":"command-reference/#dice","title":"<code>dice</code>","text":"<p>Roll dice with various configurations.</p> <p>Usage: - <code>dice</code> - Roll a standard 6-sided die (d6) - <code>dice d&lt;N&gt;</code> - Roll a die with N sides - <code>dice &lt;X&gt;d&lt;N&gt;</code> - Roll X dice with N sides each</p> <p>Examples: <pre><code>dice\ndice d20\ndice 2d6\ndice 3d10\n</code></pre></p> <p>Response: Shows the dice roll result(s) and total.</p>"},{"location":"command-reference/#roll","title":"<code>roll</code>","text":"<p>Roll a random number within a specified range.</p> <p>Usage: - <code>roll</code> - Roll a number between 1 and 100 - <code>roll &lt;max&gt;</code> - Roll a number between 1 and max</p> <p>Examples: <pre><code>roll\nroll 50\nroll 1000\n</code></pre></p> <p>Response: Shows the random number result.</p>"},{"location":"command-reference/#entertainment-commands","title":"Entertainment Commands","text":""},{"location":"command-reference/#joke","title":"<code>joke</code>","text":"<p>Get a random joke from various categories.</p> <p>Usage: - <code>joke</code> - Get a random joke - <code>joke &lt;category&gt;</code> - Get a joke from a specific category</p> <p>Examples: <pre><code>joke\njoke programming\njoke pun\n</code></pre></p> <p>Response: A random joke from the selected category.</p>"},{"location":"command-reference/#dadjoke","title":"<code>dadjoke</code>","text":"<p>Get a dad joke from icanhazdadjoke.com.</p> <p>Usage: <pre><code>dadjoke\n</code></pre></p> <p>Response: A random dad joke.</p>"},{"location":"command-reference/#hacker","title":"<code>hacker</code>","text":"<p>Responds to Linux/Unix commands with supervillain mainframe error messages.</p> <p>Usage: <pre><code>sudo\nps aux\ngrep\nls -l\ncat\nrm -rf\n</code></pre></p> <p>Examples: <pre><code>sudo make me a sandwich\nps aux | grep evil\nls -l /secret/base\n</code></pre></p> <p>Response: Humorous error messages in the style of a supervillain's mainframe system.</p>"},{"location":"command-reference/#sports-commands","title":"Sports Commands","text":""},{"location":"command-reference/#sports","title":"<code>sports</code>","text":"<p>Get sports scores for configured teams or leagues.</p> <p>Usage: - <code>sports</code> - Get scores for default teams - <code>sports &lt;team&gt;</code> - Get scores for a specific team - <code>sports &lt;league&gt;</code> - Get scores for a league (nfl, mlb, nba, nhl, etc.)</p> <p>Examples: <pre><code>sports\nsports seahawks\nsports nfl\nsports mlb\n</code></pre></p> <p>Response: Current scores and game information for the requested teams or league.</p>"},{"location":"command-reference/#meshcore-utility-commands","title":"MeshCore Utility Commands","text":""},{"location":"command-reference/#path-or-decode-or-route","title":"<code>path</code> or <code>decode</code> or <code>route</code>","text":"<p>Decode and display the routing path of a message.</p> <p>Usage: <pre><code>path\ndecode\nroute\n</code></pre></p> <p>Response: Shows the complete routing path the message took through the mesh network, including all intermediate nodes.</p>"},{"location":"command-reference/#prefix-xx","title":"<code>prefix &lt;XX&gt;</code>","text":"<p>Look up repeaters by two-character prefix.</p> <p>Usage: - <code>prefix &lt;XX&gt;</code> - Look up repeaters with the specified prefix - <code>prefix &lt;XX&gt; all</code> - Include all repeaters (not just active ones) - <code>prefix refresh</code> - Refresh the prefix cache - <code>prefix free</code> or <code>prefix available</code> - Show available prefixes</p> <p>Examples: <pre><code>prefix 1A\nprefix 2B all\nprefix refresh\nprefix free\n</code></pre></p> <p>Response: List of repeaters matching the prefix, including: - Repeater name - Status (active/inactive) - Last seen time - Location (if available)</p>"},{"location":"command-reference/#stats","title":"<code>stats</code>","text":"<p>Show bot usage statistics for the past 24 hours.</p> <p>Usage: - <code>stats</code> - Overall statistics - <code>stats messages</code> - Message statistics - <code>stats channels</code> - Channel statistics - <code>stats paths</code> - Path statistics</p> <p>Examples: <pre><code>stats\nstats messages\nstats channels\nstats paths\n</code></pre></p> <p>Response: Usage statistics including: - Total messages processed - Commands executed - Channel activity - Routing path information</p>"},{"location":"command-reference/#multitest-or-mt","title":"<code>multitest</code> or <code>mt</code>","text":"<p>Listen for 6 seconds and collect all unique paths from incoming messages.</p> <p>Usage: <pre><code>multitest\nmt\n</code></pre></p> <p>Response: List of all unique routing paths discovered during the 6-second listening period.</p>"},{"location":"command-reference/#command-syntax","title":"Command Syntax","text":""},{"location":"command-reference/#prefix","title":"Prefix","text":"<p>Commands can be used with or without the <code>!</code> prefix: - <code>test</code> or <code>!test</code> - Both work - <code>wx 98101</code> or <code>!wx 98101</code> - Both work</p>"},{"location":"command-reference/#direct-messages","title":"Direct Messages","text":"<p>Some commands work in both public channels and direct messages, while admin commands typically require direct messages for security.</p>"},{"location":"command-reference/#rate-limiting","title":"Rate Limiting","text":"<p>The bot implements rate limiting to prevent spam. If you send commands too quickly, you may receive a rate limit message. Wait a few seconds before trying again.</p>"},{"location":"command-reference/#case-sensitivity","title":"Case Sensitivity","text":"<p>Most commands are case-insensitive: - <code>TEST</code> and <code>test</code> work the same - <code>WX 98101</code> and <code>wx 98101</code> work the same</p>"},{"location":"command-reference/#getting-help","title":"Getting Help","text":"<p>Use the <code>help</code> command to get more information: - <code>help</code> - List all commands - <code>help &lt;command&gt;</code> - Get detailed help for a specific command</p>"},{"location":"command-reference/#additional-notes","title":"Additional Notes","text":""},{"location":"command-reference/#location-requirements","title":"Location Requirements","text":"<p>Some commands use location data: - <code>sun</code> and <code>moon</code> - Use the bot's configured default location (<code>bot_latitude</code> and <code>bot_longitude</code> in config.ini), not the user's location from their advert - <code>solar</code> - Does not require location (provides global solar conditions) - <code>solarforecast</code> - Requires a location parameter (location name, repeater name, coordinates, or zipcode) - <code>wx</code> - Requires a zipcode parameter - <code>gwx</code> - Requires a location parameter - <code>aqi</code> - Requires a location parameter</p>"},{"location":"command-reference/#api-keys","title":"API Keys","text":"<p>Some commands require API keys to be configured in <code>config.ini</code>: - <code>satpass</code> - Requires <code>n2yo_api_key</code> - <code>aqi</code> - Requires <code>airnow_api_key</code> (optional, uses fallback if not configured)</p>"},{"location":"command-reference/#weather-data","title":"Weather Data","text":"<ul> <li><code>wx</code> uses NOAA API (US locations only)</li> <li><code>gwx</code> uses Open-Meteo API (global locations)</li> <li>Both provide current conditions and forecasts</li> </ul>"},{"location":"command-reference/#command-categories","title":"Command Categories","text":"<p>Commands are organized into categories for easier discovery: - Basic - Essential commands for testing and help - Information - Weather, astronomy, and data queries - Emergency - Emergency and safety information - Gaming - Fun commands for games and random numbers - Entertainment - Jokes and humorous responses - Sports - Sports scores and information - MeshCore Utility - Network-specific utilities - Admin - Administrative commands (DM only)</p>"},{"location":"command-reference/#admin-commands","title":"Admin Commands","text":"<p>Note: Admin commands are only available via Direct Message (DM) and may require ACL permissions.</p>"},{"location":"command-reference/#repeater-or-repeaters-or-rp","title":"<code>repeater</code> or <code>repeaters</code> or <code>rp</code>","text":"<p>Manage repeater contacts and contact list capacity.</p> <p>Usage: <pre><code>repeater &lt;subcommand&gt; [options]\nrepeaters &lt;subcommand&gt; [options]\nrp &lt;subcommand&gt; [options]\n</code></pre></p>"},{"location":"command-reference/#repeater-management-subcommands","title":"Repeater Management Subcommands","text":"<ul> <li><code>scan</code> - Scan current contacts and catalog new repeaters</li> <li><code>list</code> - List repeater contacts (use <code>--all</code> to show purged ones)</li> <li><code>locations</code> - Show location data status for repeaters</li> <li><code>update-geo</code> - Update missing geolocation data (state/country) from coordinates</li> <li><code>update-geo dry-run</code> - Preview what would be updated without making changes</li> <li><code>update-geo &lt;N&gt;</code> - Update up to N repeaters (default: 10)</li> <li><code>update-geo dry-run &lt;N&gt;</code> - Preview updates for up to N repeaters</li> <li><code>purge all</code> - Purge all repeaters</li> <li><code>purge all force</code> - Force purge all repeaters (uses multiple removal methods)</li> <li><code>purge &lt;days&gt;</code> - Purge repeaters older than specified days</li> <li><code>purge &lt;name&gt;</code> - Purge specific repeater by name</li> <li><code>restore &lt;name&gt;</code> - Restore a previously purged repeater</li> <li><code>stats</code> - Show repeater management statistics</li> </ul>"},{"location":"command-reference/#contact-list-management-subcommands","title":"Contact List Management Subcommands","text":"<ul> <li><code>status</code> - Show contact list status and limits</li> <li><code>manage</code> - Manage contact list to prevent hitting limits</li> <li><code>manage --dry-run</code> - Show what management actions would be taken</li> <li><code>add &lt;name&gt; [key]</code> - Add a discovered contact to contact list</li> <li><code>auto-purge</code> - Show auto-purge status and controls</li> <li><code>auto-purge trigger</code> - Manually trigger auto-purge</li> <li><code>auto-purge enable/disable</code> - Enable/disable auto-purge</li> <li><code>purge-status</code> - Show detailed purge status and recommendations</li> <li><code>test-purge</code> - Test the improved purge system</li> <li><code>discover</code> - Discover companion contacts</li> <li><code>auto &lt;on|off&gt;</code> - Toggle manual contact addition setting</li> <li><code>test</code> - Test meshcore-cli command functionality</li> </ul> <p>Examples: <pre><code>repeater scan\nrepeater status\nrepeater manage\nrepeater manage --dry-run\nrepeater add \"John\"\nrepeater discover\nrepeater auto-purge\nrepeater auto-purge trigger\nrepeater purge-status\nrepeater purge all\nrepeater purge 30\nrepeater stats\n</code></pre></p> <p>Response: Varies by subcommand. Provides information about repeater contacts, contact list capacity, and management actions.</p> <p>Note: This system helps manage both repeater contacts and overall contact list capacity. It automatically removes stale contacts and old repeaters when approaching device limits.</p> <p>Automatic Features: - NEW_CONTACT events are automatically monitored - Repeaters are automatically cataloged when discovered - Contact list capacity is monitored in real-time - <code>auto_manage_contacts = device</code>: Device handles auto-addition, bot manages capacity - <code>auto_manage_contacts = bot</code>: Bot automatically adds companion contacts and manages capacity - <code>auto_manage_contacts = false</code>: Manual mode - use <code>!repeater</code> commands to manage contacts</p>"},{"location":"command-reference/#advert","title":"<code>advert</code>","text":"<p>Send a network flood advert to announce the bot's presence on the mesh network.</p> <p>Usage: <pre><code>advert\n</code></pre></p> <p>Response: Confirms that the advert was sent.</p> <p>Note:  - DM only command - 1-hour cooldown period between uses - Sends a flood advert to all nodes on the network</p>"},{"location":"command-reference/#feed","title":"<code>feed</code>","text":"<p>Manage RSS feed and API feed subscriptions (Admin only).</p> <p>Usage: <pre><code>feed &lt;subcommand&gt; [options]\n</code></pre></p>"},{"location":"command-reference/#subcommands","title":"Subcommands","text":"<ul> <li><code>subscribe &lt;rss|api&gt; &lt;url&gt; &lt;channel&gt; [name]</code> - Subscribe to a feed</li> <li><code>unsubscribe &lt;id|url&gt; &lt;channel&gt;</code> - Unsubscribe from a feed</li> <li><code>list [channel]</code> - List all subscriptions</li> <li><code>status &lt;id&gt;</code> - Get status of a specific subscription</li> <li><code>test &lt;url&gt;</code> - Test a feed URL</li> <li><code>enable &lt;id&gt;</code> - Enable a subscription</li> <li><code>disable &lt;id&gt;</code> - Disable a subscription</li> <li><code>update &lt;id&gt; [interval_seconds]</code> - Update subscription interval</li> </ul> <p>Examples: <pre><code>feed subscribe rss https://alerts.example.com/rss emergency \"Emergency Alerts\"\nfeed subscribe api https://api.example.com/alerts emergency \"API Alerts\" '{\"headers\": {\"Authorization\": \"Bearer TOKEN\"}}'\nfeed list\nfeed status 1\nfeed test https://example.com/feed.xml\n</code></pre></p> <p>Response: Confirmation of the action or list of subscriptions.</p> <p>Note: Admin access required. Feeds are automatically checked and posted to the specified channel.</p> <p>For more information about configuring the bot, see the main README file.</p>"},{"location":"config-validation/","title":"Config validation","text":"<p>The bot can validate your <code>config.ini</code> for section names and path writability before you run it. Use this to catch typos (e.g. <code>[WebViewer]</code> instead of <code>[Web_Viewer]</code>) and missing required sections.</p>"},{"location":"config-validation/#how-to-run","title":"How to run","text":"<p>Standalone script (no bot startup):</p> <pre><code>python validate_config.py [--config config.ini]\n</code></pre> <p>At bot startup (validate then exit):</p> <pre><code>python meshcore_bot.py --validate-config [--config config.ini]\n</code></pre> <ul> <li>Exit 0 \u2013 No errors (warnings and info may still be printed).</li> <li>Exit 1 \u2013 One or more errors; fix them before starting the bot.</li> </ul> <p>Warnings and info do not change the exit code. Only errors cause exit 1.</p>"},{"location":"config-validation/#what-is-checked","title":"What is checked","text":""},{"location":"config-validation/#required-sections","title":"Required sections","text":"<p>The bot will not start without these sections. The validator reports them as errors if missing:</p> Section Purpose <code>[Connection]</code> Serial, BLE, or TCP connection parameters <code>[Bot]</code> Database path, bot name, rate limits, etc. <code>[Channels]</code> Monitor channels, DM behavior"},{"location":"config-validation/#section-names","title":"Section names","text":"<ul> <li>Canonical sections (e.g. <code>[Web_Viewer]</code>, <code>[Feed_Manager]</code>) and any section ending in <code>_Command</code> (e.g. <code>[Path_Command]</code>, <code>[Wx_Command]</code>) are valid.</li> <li>Known typos are reported as warnings with a suggestion, for example:</li> <li><code>[WebViewer]</code> \u2192 use <code>[Web_Viewer]</code></li> <li><code>[FeedManager]</code> \u2192 use <code>[Feed_Manager]</code></li> <li><code>[Jokes]</code> \u2192 use <code>[Joke_Command]</code> / <code>[DadJoke_Command]</code> (see Configuration and Upgrade for legacy support).</li> <li>Unknown sections (not in the canonical list and not a <code>*_Command</code> section) are reported as info; the validator may suggest a similar section name if it looks like a command.</li> </ul>"},{"location":"config-validation/#optional-sections-info-only","title":"Optional sections (info only)","text":"<p>If these are absent, the validator reports info (no error):</p> <ul> <li><code>[Admin_ACL]</code> \u2013 Absent means admin commands (repeater, webviewer, reload) are disabled.</li> <li><code>[Banned_Users]</code> \u2013 Absent means no users are banned.</li> <li><code>[Localization]</code> \u2013 Absent means defaults (e.g. <code>language=en</code>, <code>translation_path=translations/</code>) are used.</li> </ul>"},{"location":"config-validation/#path-writability","title":"Path writability","text":"<p>The validator checks that paths for database, log file, and Web_Viewer db_path (when set) are writable. Problems are reported as warnings (e.g. directory does not exist or is not writable). Relative paths are resolved from the directory containing the config file.</p>"},{"location":"config-validation/#severity-levels","title":"Severity levels","text":"Level Effect on exit code Typical meaning Error Exit 1 Must fix (e.g. missing section) Warning Exit 0 Likely mistake (e.g. section typo) Info Exit 0 Informational (e.g. optional section absent)"},{"location":"config-validation/#example","title":"Example","text":"<pre><code>$ python validate_config.py --config config.ini\nWarning: Non-standard section [WebViewer]; did you mean [Web_Viewer]?\nInfo: Section [Localization] absent; using defaults (language=en, translation_path=translations/).\n</code></pre> <p>Fix the <code>[WebViewer]</code> section name, then re-run. After fixing errors, the bot can start normally; you can also run with <code>--validate-config</code> before each start if you prefer.</p>"},{"location":"configuration/","title":"Configuration","text":"<p>The bot is configured via <code>config.ini</code> in the project root (or the path given with <code>--config</code>). This page describes how configuration is organized and where to find command-specific options.</p>"},{"location":"configuration/#configini-structure","title":"config.ini structure","text":"<ul> <li>Sections are named in square brackets, e.g. <code>[Bot]</code>, <code>[Connection]</code>, <code>[Path_Command]</code>.</li> <li>Options are <code>key = value</code> (or <code>key=value</code>). Comments start with <code>#</code> or <code>;</code>.</li> <li>Paths can be relative (to the directory containing the config file) or absolute. For Docker, use absolute paths under <code>/data/</code> (see Docker deployment).</li> </ul> <p>The main sections include:</p> Section Purpose <code>[Bot]</code> Bot name, database path, response toggles, command prefix <code>[Connection]</code> Serial, BLE, or TCP connection to the MeshCore device <code>[Channels]</code> Channels to monitor, DM behavior, optional channel keyword whitelist <code>[Admin_ACL]</code> Admin public keys and admin-only commands <code>[Keywords]</code> Keyword \u2192 response pairs <code>[Weather]</code> Units and settings shared by <code>wx</code> / <code>gwx</code> and Weather Service <code>[Logging]</code> Log file path and level"},{"location":"configuration/#channels-section","title":"Channels section","text":"<p><code>[Channels]</code> controls where the bot responds:</p> <ul> <li><code>monitor_channels</code> \u2013 Comma-separated channel names. The bot only responds to messages on these channels (and in DMs if enabled).</li> <li><code>respond_to_dms</code> \u2013 If <code>true</code>, the bot responds to direct messages; if <code>false</code>, it ignores DMs.</li> <li><code>channel_keywords</code> \u2013 Optional. When set (comma-separated command/keyword names), only those triggers are answered in channels; DMs always get all triggers. Use this to reduce channel traffic by making heavy triggers (e.g. <code>wx</code>, <code>satpass</code>, <code>joke</code>) DM-only. Leave empty or omit to allow all triggers in monitored channels. Per-command <code>channels =</code> (empty) in a command\u2019s section also forces that command to be DM-only; see <code>config.ini.example</code> for examples (e.g. <code>[Joke_Command]</code>).</li> </ul>"},{"location":"configuration/#command-and-feature-sections","title":"Command and feature sections","text":"<p>Many commands and features have their own section. Options there control whether the command is enabled and how it behaves.</p>"},{"location":"configuration/#enabling-and-disabling-commands","title":"Enabling and disabling commands","text":"<ul> <li><code>enabled</code> \u2013 Common option to turn a command or plugin on or off. Example:   <pre><code>[Aurora_Command]\nenabled = true\n</code></pre></li> <li>Commands without an <code>enabled</code> key are typically always available (subject to Admin_ACL for admin-only commands).</li> </ul>"},{"location":"configuration/#command-specific-sections","title":"Command-specific sections","text":"<p>Examples of sections that configure specific commands or features:</p> <ul> <li><code>[Path_Command]</code> \u2013 Path decoding and repeater selection. See Path Command for all options.</li> <li><code>[Prefix_Command]</code> \u2013 Prefix lookup, prefix best, range limits.</li> <li><code>[Weather]</code> \u2013 Used by the <code>wx</code> / <code>gwx</code> commands and the Weather Service plugin (see Weather Service).</li> <li><code>[Airplanes_Command]</code> \u2013 Aircraft/ADS-B command (API URL, radius, limits).</li> <li><code>[Aurora_Command]</code> \u2013 Aurora command (default coordinates).</li> <li><code>[Alert_Command]</code> \u2013 Emergency alerts (agency IDs, etc.).</li> <li><code>[Sports_Command]</code> \u2013 Sports scores (teams, leagues).</li> <li><code>[Joke_Command]</code>, <code>[DadJoke_Command]</code> \u2013 Joke sources and options.</li> </ul> <p>Full reference: see <code>config.ini.example</code> in the repository for every section and option, with inline comments.</p>"},{"location":"configuration/#path-command-configuration","title":"Path Command configuration","text":"<p>The Path command has many options (presets, proximity, graph validation, etc.). All are documented in:</p> <p>Path Command \u2013 Presets, geographic and graph settings, and tuning.</p>"},{"location":"configuration/#service-plugin-configuration","title":"Service plugin configuration","text":"<p>Service plugins (Discord Bridge, Packet Capture, Map Uploader, Weather Service) each have their own section and are documented under Service Plugins.</p>"},{"location":"configuration/#config-validation","title":"Config validation","text":"<p>Before starting the bot, you can validate section names and path writability. See Config validation for how to run <code>validate_config.py</code> or <code>meshcore_bot.py --validate-config</code>, and what is checked (required sections, typos like <code>[WebViewer]</code> \u2192 <code>[Web_Viewer]</code>, and writable paths).</p>"},{"location":"configuration/#reloading-configuration","title":"Reloading configuration","text":"<p>Some configuration can be reloaded without restarting the bot using the <code>reload</code> command (admin only). Radio/connection settings are not changed by reload; restart the bot for those.</p>"},{"location":"discord-bridge/","title":"Discord Bridge Service","text":"<p>The Discord Bridge service posts MeshCore channel messages to Discord channels via webhooks. This is a one-way, read-only bridge - messages only flow from MeshCore to Discord.</p> <p>Features: - One-way message flow (MeshCore \u2192 Discord only) - Multi-channel mapping (map multiple MeshCore channels to different Discord channels) - Webhook-based (simple, secure, no bot permissions needed) - DMs are NEVER bridged (hardcoded for privacy) - Rate limit monitoring (warns when approaching Discord's limits) - Disabled by default (opt-in)</p>"},{"location":"discord-bridge/#quick-start","title":"Quick Start","text":""},{"location":"discord-bridge/#1-create-discord-webhook","title":"1. Create Discord Webhook","text":"<ol> <li>Open Discord and navigate to your channel</li> <li>Click \u2699\ufe0f Channel Settings \u2192 Integrations \u2192 Webhooks</li> <li>Click Create Webhook</li> <li>Copy the webhook URL</li> </ol>"},{"location":"discord-bridge/#2-configure-bot","title":"2. Configure Bot","text":"<p>Edit <code>config.ini</code>:</p> <pre><code>[DiscordBridge]\nenabled = true\n\n# Map MeshCore channels to Discord webhooks\nbridge.general = https://discord.com/api/webhooks/YOUR_WEBHOOK_URL_HERE\n</code></pre>"},{"location":"discord-bridge/#3-restart-bot","title":"3. Restart Bot","text":"<pre><code>sudo systemctl restart meshcore-bot\n# OR if running manually: python3 meshcore_bot.py\n</code></pre>"},{"location":"discord-bridge/#4-test","title":"4. Test","text":"<p>Send a message on the MeshCore channel - it should appear in Discord!</p>"},{"location":"discord-bridge/#configuration","title":"Configuration","text":""},{"location":"discord-bridge/#basic-setup","title":"Basic Setup","text":"<pre><code>[DiscordBridge]\nenabled = true\n\n# Avatar style (optional)\n# Options: color (default), fun-emoji, avataaars, bottts, identicon, pixel-art, adventurer, initials\navatar_style = color\n\n# Map MeshCore channels to Discord webhooks\nbridge.general = https://discord.com/api/webhooks/123456789012345678/abcdefghijklmnopqrstuvwxyz1234567890ABCD\nbridge.emergency = https://discord.com/api/webhooks/987654321098765432/ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgf\n</code></pre> <p>Important: Only channels explicitly listed will be bridged. Any channel not in the config will be ignored.</p>"},{"location":"discord-bridge/#avatar-styles","title":"Avatar Styles","text":"<p>Control how user avatars appear in Discord:</p> <ul> <li>color (default): Discord's built-in colored avatars based on username hash (no external API)</li> <li>fun-emoji: Colorful emoji-based avatars</li> <li>avataaars: Cartoon-style avatar faces</li> <li>bottts: Robot-themed avatars</li> <li>identicon: Geometric patterns (GitHub-style)</li> <li>pixel-art: Retro pixel-art style</li> <li>adventurer: Adventure-themed characters</li> <li>initials: User's initials on colored background</li> </ul> <p>Preview: <code>https://api.dicebear.com/7.x/{style}/png?seed=YourName</code></p>"},{"location":"discord-bridge/#security-privacy","title":"Security &amp; Privacy","text":""},{"location":"discord-bridge/#webhook-urls-contain-secrets","title":"Webhook URLs Contain Secrets","text":"<p>\u26a0\ufe0f IMPORTANT: Webhook URLs contain authentication tokens. Anyone with a webhook URL can post to your Discord channel.</p> <ul> <li>Never commit webhook URLs to version control</li> <li>Keep <code>config.ini</code> secure and private</li> <li>Add <code>config.ini</code> to <code>.gitignore</code> (already done)</li> <li>Rotate webhook URLs immediately if exposed</li> </ul>"},{"location":"discord-bridge/#dms-are-never-bridged","title":"DMs Are Never Bridged","text":"<p>For privacy, DMs are NEVER bridged to Discord. This is hardcoded and cannot be changed via configuration. Only channel messages from explicitly configured channels are posted to Discord.</p>"},{"location":"discord-bridge/#rate-limits","title":"Rate Limits","text":"<p>Discord webhooks are limited to 30 messages per minute per webhook. The service monitors rate limit headers and logs warnings when within 20% of exhaustion:</p> <pre><code>WARNING - Discord rate limit warning [general]: 6/30 requests remaining (20.0%). Resets at: 2026-01-03 21:15:00\n</code></pre> <p>If you have high-traffic channels: - Use a dedicated webhook for that channel - Filter messages at the source - Increase <code>bot_tx_rate_limit_seconds</code> in <code>[Bot]</code> section</p>"},{"location":"discord-bridge/#message-format","title":"Message Format","text":"<p>Messages appear in Discord with the sender's name as the webhook username:</p> <pre><code>[Avatar] Jade\nseriously, there are some people...\n</code></pre> <p>MeshCore @ mentions are cleaned up and bolded: <code>@[username]</code> \u2192 <code>**@username**</code></p>"},{"location":"discord-bridge/#troubleshooting","title":"Troubleshooting","text":""},{"location":"discord-bridge/#service-not-starting","title":"Service Not Starting","text":"<p>Check logs: <pre><code>tail -f meshcore_bot.log | grep DiscordBridge\n</code></pre></p> <p>Common issues: - <code>enabled = false</code> in config - No channel mappings configured - Invalid webhook URLs</p>"},{"location":"discord-bridge/#messages-not-appearing-in-discord","title":"Messages Not Appearing in Discord","text":"<ol> <li>Verify channel is configured: Check that <code>bridge.&lt;channelname&gt;</code> exists in config</li> <li>Check webhook URL: Ensure URL is correct and webhook exists in Discord</li> <li>Test webhook manually:    <pre><code>curl -X POST \"YOUR_WEBHOOK_URL\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"content\": \"Test message\"}'\n</code></pre></li> <li>Check logs: Look for errors in <code>meshcore_bot.log</code></li> </ol>"},{"location":"discord-bridge/#rate-limit-warnings","title":"Rate Limit Warnings","text":"<p>If you see frequent rate limit warnings: 1. Check message volume - is the channel very active? 2. Adjust bot rate limiting: increase <code>bot_tx_rate_limit_seconds</code> 3. Filter messages: only bridge important channels 4. Use multiple webhooks: each has its own rate limit</p>"},{"location":"discord-bridge/#faq","title":"FAQ","text":"<p>Q: Can I bridge messages from Discord to MeshCore? A: No. This is intentionally a one-way bridge for security and simplicity.</p> <p>Q: Can I bridge DMs? A: No. DMs are never bridged for privacy. This is hardcoded and cannot be changed.</p> <p>Q: Can I use a Discord bot instead of webhooks? A: The service uses webhooks by design. Webhooks are simpler, more secure for one-way messaging, and don't require bot permissions.</p> <p>Q: What happens if a webhook is deleted in Discord? A: The service will log errors when trying to post. Remove the mapping from config or create a new webhook.</p> <p>Q: Can I use the same webhook for multiple MeshCore channels? A: Yes, but all messages will appear in the same Discord channel. The webhook username will show which MeshCore channel it came from.</p> <p>Q: How do I disable the bridge temporarily? A: Set <code>enabled = false</code> in the <code>[DiscordBridge]</code> section and restart the bot.</p> <p>Q: Does this work with Discord threads? A: Webhooks post to the channel, not specific threads. Consider creating separate channels for different topics.</p>"},{"location":"discord-bridge/#implementation-details","title":"Implementation Details","text":"<p>Architecture: - Inherits from <code>BaseServicePlugin</code> - Event-driven: subscribes to <code>EventType.CHANNEL_MSG_RECV</code> - Async HTTP via <code>aiohttp</code> (fallback to <code>requests</code>) - Rate limit monitoring via <code>X-RateLimit-Remaining</code> headers</p> <p>File Locations: - Service: <code>modules/service_plugins/discord_bridge_service.py</code> - Config: <code>config.ini</code> (section <code>[DiscordBridge]</code>) - Example: <code>config.ini.example</code> - Tests: <code>test_scripts/test_discord_bridge_*.py</code></p> <p>Dependencies: Uses existing <code>aiohttp</code> and <code>requests</code> libraries - no additional dependencies needed!</p>"},{"location":"faq/","title":"FAQ","text":"<p>Frequently asked questions about meshcore-bot.</p>"},{"location":"faq/#installation-and-upgrades","title":"Installation and upgrades","text":""},{"location":"faq/#will-using-upgrade-on-the-install-script-move-over-the-settings-file-as-well-as-upgrade-the-bot","title":"Will using <code>--upgrade</code> on the install script move over the settings file as well as upgrade the bot?","text":"<p>No. The install script never overwrites an existing <code>config.ini</code> in the installation directory. Whether you run it with or without <code>--upgrade</code>, your current <code>config.ini</code> is left as-is. So your settings are preserved when you upgrade.</p> <p>With <code>--upgrade</code>, the script also updates the service definition (systemd unit or launchd plist) and reloads the service so the new code and any changed paths take effect.</p>"},{"location":"faq/#if-i-dont-use-upgrade-is-the-bot-still-upgraded-after-git-pull-and-running-the-install-script","title":"If I don't use <code>--upgrade</code>, is the bot still upgraded after <code>git pull</code> and running the install script?","text":"<p>Partially. The script still copies repo files into the install directory and only overwrites when the source file is newer (and it never overwrites <code>config.ini</code>). So the installed code is upgraded.</p> <p>Without <code>--upgrade</code>, the script does not update the service file (systemd/launchd) and does not reload the service. So:</p> <ul> <li>New bot code is on disk.</li> <li>The running service may still be using the old code until you restart it (e.g. <code>sudo systemctl restart meshcore-bot</code> or equivalent).</li> <li>Any changes to the service definition (paths, user, etc.) in the script are not applied.</li> </ul> <p>Recommendation: Use <code>./install-service.sh --upgrade</code> after <code>git pull</code> when you want to upgrade; that updates files, dependencies, and the service, and reloads the service, while keeping your <code>config.ini</code> intact.</p>"},{"location":"faq/#command-reference-and-website","title":"Command reference and website","text":""},{"location":"faq/#how-can-i-generate-a-custom-command-reference-for-my-bot-users","title":"How can I generate a custom command reference for my bot users?","text":"<p>See Custom command reference website: it explains how to use <code>generate_website.py</code> to build a single-page HTML from your config (with optional styles) and upload it to your site.</p>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Get meshcore-bot running on your machine in a few minutes.</p>"},{"location":"getting-started/#requirements","title":"Requirements","text":"<ul> <li>Python 3.7+</li> <li>MeshCore-compatible device (Heltec V3, RAK Wireless, etc.)</li> <li>Connection: USB cable, BLE, or TCP/IP to the device</li> </ul>"},{"location":"getting-started/#quick-start-development","title":"Quick start (development)","text":"<ol> <li>Clone and install</li> </ol> <pre><code>git clone https://github.com/agessaman/meshcore-bot.git\ncd meshcore-bot\npip install -r requirements.txt\n</code></pre> <ol> <li>Configure</li> </ol> <p>Copy an example config and edit with your connection and bot settings:</p> <ul> <li>Full config (all commands and options):      <pre><code>cp config.ini.example config.ini\n</code></pre></li> <li>Minimal config (core commands only: ping, test, path, prefix, multitest):      <pre><code>cp config.ini.minimal-example config.ini\n</code></pre></li> </ul> <p>Edit <code>config.ini</code>: set at least <code>[Connection]</code> (serial/BLE/TCP) and <code>[Bot]</code> (e.g. <code>bot_name</code>).</p> <ol> <li>Run</li> </ol> <pre><code>python3 meshcore_bot.py\n</code></pre>"},{"location":"getting-started/#production-deployment","title":"Production deployment","text":""},{"location":"getting-started/#systemd-service","title":"Systemd service","text":"<p>Run the bot as a system service on Linux:</p> <pre><code>sudo ./install-service.sh\nsudo nano /opt/meshcore-bot/config.ini   # configure\nsudo systemctl start meshcore-bot\nsudo systemctl status meshcore-bot\n</code></pre> <p>See Service installation for full steps.</p>"},{"location":"getting-started/#docker","title":"Docker","text":"<p>Run in a container with Docker Compose:</p> <pre><code>mkdir -p data/{config,databases,logs,backups}\ncp config.ini.example data/config/config.ini\n# Edit data/config/config.ini and set paths to /data/... (see [Docker](docker.md))\ndocker compose up -d --build\n</code></pre> <p>See Docker deployment for paths, serial access, and troubleshooting.</p>"},{"location":"getting-started/#nixos","title":"NixOS","text":"<p>Use the flake:</p> <pre><code>meshcore-bot.url = \"github:agessaman/meshcore-bot/\";\n</code></pre>"},{"location":"getting-started/#next-steps","title":"Next steps","text":"<ul> <li>Command Reference \u2014 Full command reference (wx, aqi, sun, path, prefix, etc.)</li> <li>README \u2014 Features, keywords, configuration overview</li> <li>Guides (sidebar) \u2014 Path command, repeater commands, feeds, weather service, Discord bridge, map uploader, packet capture</li> </ul>"},{"location":"installation/","title":"Installation","text":"<p>Choose how to run the bot:</p> Method Best for Docker Containers, consistent environments, easy updates Service (systemd) Linux servers, run at boot, no containers <p>See Getting started for a quick development setup (run from the repo with <code>python meshcore_bot.py</code>).</p>"},{"location":"map-uploader/","title":"Map Uploader Service","text":"<p>Uploads node advertisements to map.meshcore.dev for network visualization.</p>"},{"location":"map-uploader/#quick-start","title":"Quick Start","text":"<ol> <li>Configure Bot - Edit <code>config.ini</code>:</li> </ol> <pre><code>[MapUploader]\nenabled = true\n</code></pre> <ol> <li>Restart Bot - The service starts automatically and uploads node adverts with GPS coordinates</li> </ol>"},{"location":"map-uploader/#configuration","title":"Configuration","text":""},{"location":"map-uploader/#basic-settings","title":"Basic Settings","text":"<pre><code>[MapUploader]\nenabled = true                        # Enable map uploader\napi_url = https://map.meshcore.dev/api/v1/uploader/node  # API endpoint\nmin_reupload_interval = 3600          # Minimum seconds between re-uploads (1 hour)\nverbose = false                       # Detailed debug logging\n</code></pre>"},{"location":"map-uploader/#private-key-optional","title":"Private Key (Optional)","text":"<p>The service needs your device's private key to sign uploads. It will automatically fetch the key from your device if supported.</p> <p>Manual Configuration: <pre><code>private_key_path = /path/to/private_key.txt\n</code></pre></p>"},{"location":"map-uploader/#how-it-works","title":"How It Works","text":"<ol> <li>Listens for ADVERT packets on the mesh network</li> <li>Verifies packet signature using Ed25519</li> <li>Filters invalid packets:</li> <li>Missing GPS coordinates (lat/lon)</li> <li>Coordinates exactly 0.0 (invalid)</li> <li>CHAT adverts (only nodes are uploaded)</li> <li>Duplicate/replay attacks</li> <li>Uploads valid node adverts to the map with your radio parameters</li> <li>Prevents spam - Only re-uploads the same node after <code>min_reupload_interval</code></li> </ol>"},{"location":"map-uploader/#what-gets-uploaded","title":"What Gets Uploaded","text":""},{"location":"map-uploader/#node-types-uploaded","title":"Node Types Uploaded","text":"<ul> <li>Repeaters</li> <li>Room servers</li> <li>Sensors</li> <li>Other non-CHAT adverts with GPS coordinates</li> </ul>"},{"location":"map-uploader/#data-included","title":"Data Included","text":"<pre><code>{\n  \"params\": {\n    \"freq\": 915000000,\n    \"cr\": 8,\n    \"sf\": 9,\n    \"bw\": 250000\n  },\n  \"links\": [\"meshcore://DEADBEEF...\"]\n}\n</code></pre>"},{"location":"map-uploader/#whats-not-uploaded","title":"What's NOT Uploaded","text":"<ul> <li>CHAT adverts (companion devices)</li> <li>Nodes without GPS coordinates</li> <li>Nodes with invalid coordinates (0.0, 0.0)</li> <li>Duplicate packets (same node within <code>min_reupload_interval</code>)</li> </ul>"},{"location":"map-uploader/#signature-verification","title":"Signature Verification","text":"<p>All uploads are signed with your device's private key to ensure authenticity:</p> <ol> <li>Ed25519 signature proves you received the packet</li> <li>Radio parameters show your device config</li> <li>Raw packet data allows independent verification</li> </ol> <p>Security: Map operators can verify uploads came from legitimate devices.</p>"},{"location":"map-uploader/#troubleshooting","title":"Troubleshooting","text":""},{"location":"map-uploader/#service-not-starting","title":"Service Not Starting","text":"<p>Check logs: <pre><code>tail -f meshcore_bot.log | grep MapUploader\n</code></pre></p> <p>Common issues: - <code>enabled = false</code> in config - Missing dependencies: <code>pip install aiohttp cryptography</code> - No private key available</p>"},{"location":"map-uploader/#no-uploads-happening","title":"No Uploads Happening","text":"<ol> <li>Check for adverts - Service only uploads when it receives ADVERT packets</li> <li>Verify coordinates - Nodes must have valid GPS coordinates</li> <li>Check signature - Service logs \"signature verification failed\" for invalid packets</li> <li>Check interval - Same node won't re-upload within <code>min_reupload_interval</code></li> </ol>"},{"location":"map-uploader/#private-key-errors","title":"Private Key Errors","text":"<p>Error: \"Could not obtain private key\"</p> <p>Solutions: 1. Ensure your device firmware supports private key export 2. Manually provide key via <code>private_key_path</code> 3. Check file permissions if using file path</p>"},{"location":"map-uploader/#advanced","title":"Advanced","text":""},{"location":"map-uploader/#memory-management","title":"Memory Management","text":"<p>The service tracks seen adverts to prevent duplicates. Old entries are automatically cleaned: - Hourly cleanup removes entries older than <code>2 \u00d7 min_reupload_interval</code> - Safety limit: Keeps only 5000 most recent entries if dictionary grows beyond 10,000</p>"},{"location":"map-uploader/#radio-parameters","title":"Radio Parameters","text":"<p>Your device's radio settings are included in all uploads: - freq: Frequency in Hz - cr: Coding rate - sf: Spreading factor - bw: Bandwidth in Hz</p>"},{"location":"map-uploader/#packet-format","title":"Packet Format","text":"<p>Uploads use the <code>meshcore://</code> URI scheme with hex-encoded raw packet data for verification.</p>"},{"location":"map-uploader/#faq","title":"FAQ","text":"<p>Q: Will this upload my location? A: No. Only node adverts (repeaters, sensors) with GPS coordinates are uploaded. CHAT adverts are never uploaded.</p> <p>Q: How often does it upload? A: Only when new node adverts are received. Same node won't re-upload within <code>min_reupload_interval</code> (default: 1 hour).</p> <p>Q: What if my device doesn't support private key export? A: You'll need to manually provide the private key via <code>private_key_path</code>.</p> <p>Q: Can I use a different map server? A: Yes, change <code>api_url</code> to point to your own map.meshcore.dev instance.</p> <p>Q: Does it upload all packets? A: No. Only ADVERT packets from nodes with valid GPS coordinates.</p>"},{"location":"packet-capture/","title":"Packet Capture Service","text":"<p>Captures packets from the MeshCore network and publishes them to MQTT brokers.</p>"},{"location":"packet-capture/#quick-start","title":"Quick Start","text":"<ol> <li>Configure Bot - Edit <code>config.ini</code>:</li> </ol> <pre><code>[PacketCapture]\nenabled = true\n\n# Owner info for JWT auth -- these are optional\nowner_public_key = YOUR_COMPANION_PUBLIC_KEY_HERE\nowner_email = your.email@example.com\n\n# IATA code for topic routing\niata = LOC\n\n# MQTT Broker (Let's Mesh Analyzer)\nmqtt1_enabled = true\nmqtt1_server = mqtt-us-v1.letsmesh.net\nmqtt1_port = 443\nmqtt1_transport = websockets\nmqtt1_use_tls = true\nmqtt1_use_auth_token = true\nmqtt1_token_audience = mqtt-us-v1.letsmesh.net\nmqtt1_topic_status = meshcore/{IATA}/{PUBLIC_KEY}/status\nmqtt1_topic_packets = meshcore/{IATA}/{PUBLIC_KEY}/packets\n</code></pre> <ol> <li>Restart Bot - The service starts automatically</li> </ol>"},{"location":"packet-capture/#configuration","title":"Configuration","text":""},{"location":"packet-capture/#basic-settings","title":"Basic Settings","text":"<pre><code>[PacketCapture]\nenabled = true                    # Enable packet capture\noutput_file = packets.json        # Optional: save to file\nverbose = false                   # Detailed packet logging\ndebug = false                     # Debug mode\n</code></pre>"},{"location":"packet-capture/#authentication","title":"Authentication","text":""},{"location":"packet-capture/#option-1-on-device-signing-recommended","title":"Option 1: On-Device Signing (Recommended)","text":"<pre><code>auth_token_method = device        # Use device's built-in signing\n# No private key file needed\n</code></pre>"},{"location":"packet-capture/#option-2-python-signing","title":"Option 2: Python Signing","text":"<pre><code>auth_token_method = python        # Use Python signing\nprivate_key_path = /path/to/key.txt  # Path to private key file\n</code></pre>"},{"location":"packet-capture/#mqtt-brokers","title":"MQTT Brokers","text":"<p>Configure multiple brokers using <code>mqttN_*</code> pattern:</p> <pre><code># Broker 1\nmqtt1_enabled = true\nmqtt1_server = mqtt-us-v1.letsmesh.net\nmqtt1_port = 443\nmqtt1_transport = websockets      # tcp or websockets\nmqtt1_use_tls = true\nmqtt1_use_auth_token = true\nmqtt1_topic_status = meshcore/{IATA}/{PUBLIC_KEY}/status\nmqtt1_topic_packets = meshcore/{IATA}/{PUBLIC_KEY}/packets\n\n# Broker 2\nmqtt2_enabled = true\nmqtt2_server = your.broker.com\nmqtt2_port = 1883\nmqtt2_transport = tcp\nmqtt2_username = user\nmqtt2_password = pass\n</code></pre>"},{"location":"packet-capture/#topic-templates","title":"Topic Templates","text":"<p>Placeholders: - <code>{IATA}</code> - Your IATA code (e.g., SEA) - <code>{iata}</code> - Lowercase IATA code - <code>{PUBLIC_KEY}</code> - Device public key (uppercase) - <code>{public_key}</code> - Device public key (lowercase)</p>"},{"location":"packet-capture/#status-publishing","title":"Status Publishing","text":"<pre><code>stats_in_status_enabled = true    # Include device stats in status\nstats_refresh_interval = 300      # Publish status every 5 minutes\njwt_renewal_interval = 86400      # Renew JWT every 24 hours\n</code></pre>"},{"location":"packet-capture/#packet-format","title":"Packet Format","text":""},{"location":"packet-capture/#packet-message","title":"Packet Message","text":"<pre><code>{\n  \"origin\": \"MyBot\",\n  \"origin_id\": \"ABCD1234...\",\n  \"timestamp\": \"2026-01-04T12:34:56\",\n  \"type\": \"PACKET\",\n  \"direction\": \"rx\",\n  \"len\": \"42\",\n  \"packet_type\": \"2\",\n  \"route\": \"D\",\n  \"payload_len\": \"32\",\n  \"raw\": \"DEADBEEF...\",\n  \"SNR\": \"8.5\",\n  \"RSSI\": \"-42\",\n  \"hash\": \"ABC123...\"\n}\n</code></pre>"},{"location":"packet-capture/#status-message","title":"Status Message","text":"<pre><code>{\n  \"status\": \"online\",\n  \"timestamp\": \"2026-01-04T12:34:56\",\n  \"origin\": \"MyBot\",\n  \"origin_id\": \"ABCD1234...\",\n  \"model\": \"Heltec V3\",\n  \"firmware_version\": \"v3.1.2\",\n  \"radio\": \"915000000,250,9,8\",\n  \"client_version\": \"meshcore-bot/1.0.0\",\n  \"stats\": {\n    \"rx_packets\": 1234,\n    \"tx_packets\": 567\n  }\n}\n</code></pre>"},{"location":"packet-capture/#troubleshooting","title":"Troubleshooting","text":""},{"location":"packet-capture/#service-not-starting","title":"Service Not Starting","text":"<p>Check logs: <pre><code>tail -f meshcore_bot.log | grep PacketCapture\n</code></pre></p> <p>Common issues: - <code>enabled = false</code> in config - Missing <code>paho-mqtt</code> library: <code>pip install paho-mqtt</code></p>"},{"location":"packet-capture/#mqtt-not-connecting","title":"MQTT Not Connecting","text":"<ol> <li>Check broker settings - Verify hostname and port</li> <li>Test connection manually:    <pre><code>mosquitto_pub -h mqtt-us-v1.letsmesh.net -p 443 -t test -m \"test\"\n</code></pre></li> <li>Check authentication - Verify JWT token generation</li> <li>Check logs - Look for connection errors</li> </ol>"},{"location":"packet-capture/#no-packets-being-published","title":"No Packets Being Published","text":"<ol> <li>Verify MQTT connection - Check logs for \"Connected to MQTT broker\"</li> <li>Check packet count - Service logs \"Captured packet #N\" for each packet</li> <li>Verify topics - Ensure topics match broker expectations</li> </ol>"},{"location":"packet-capture/#advanced","title":"Advanced","text":""},{"location":"packet-capture/#multiple-brokers","title":"Multiple Brokers","text":"<p>Configure up to 10 brokers (mqtt1_ through mqtt10_). Each broker has independent connection tracking and auto-reconnection.</p>"},{"location":"packet-capture/#health-monitoring","title":"Health Monitoring","text":"<pre><code>health_check_interval = 30        # Check connection every 30s\nhealth_check_grace_period = 2     # Allow 2 failures before warning\n</code></pre>"},{"location":"packet-capture/#jwt-authentication","title":"JWT Authentication","text":"<p>Tokens are valid for 24 hours and auto-renewed. The service tries on-device signing first (if <code>auth_token_method = device</code>), then falls back to Python signing.</p> <p>Token Format: <pre><code>{\n  \"iat\": 1234567890,\n  \"exp\": 1234654290,\n  \"aud\": \"mqtt-us-v1.letsmesh.net\",\n  \"publicKey\": \"DEVICE_PUBLIC_KEY\",\n  \"owner\": \"OWNER_PUBLIC_KEY\",\n  \"email\": \"your@email.com\",\n  \"iata\": \"SEA\"\n}\n</code></pre></p>"},{"location":"packet-capture/#faq","title":"FAQ","text":"<p>Q: Do I need to provide a private key? A: Not if using on-device signing (<code>auth_token_method = device</code>). The service will fetch the key from your device automatically.</p> <p>Q: Can I publish to my own MQTT broker? A: Yes. Set <code>mqtt1_use_auth_token = false</code> and provide <code>mqtt1_username</code> and <code>mqtt1_password</code>.</p> <p>Q: What's the difference between TCP and WebSockets? A: WebSockets work through firewalls better (uses HTTPS port 443). TCP is lighter but may be blocked.</p> <p>Q: How do I disable packet capture but keep status publishing? A: You can't disable just packet capture - it's all or nothing. Consider filtering on the broker side.</p> <p>Q: Can I capture TX (outgoing) packets? A: Currently only RX (incoming) packets are captured.</p>"},{"location":"path-command-config/","title":"Path Command Configuration Guide","text":"<p>This document explains all configuration parameters for the Path Command, which decodes hex path data to identify repeaters in message routing paths.</p>"},{"location":"path-command-config/#quick-start-presets","title":"Quick Start: Presets","text":"<p>The Path Command supports three presets that configure multiple related settings:</p> <ul> <li><code>balanced</code> (default): Balanced approach using both graph evidence and geographic proximity</li> <li><code>geographic</code>: Prioritize geographic proximity over graph evidence (better for local networks)</li> <li><code>graph</code>: Prioritize graph evidence over geographic proximity (better for well-connected networks)</li> </ul> <p>Set the preset using: <pre><code>path_selection_preset = balanced\n</code></pre></p>"},{"location":"path-command-config/#core-settings","title":"Core Settings","text":""},{"location":"path-command-config/#geographic-proximity","title":"Geographic Proximity","text":"<p><code>proximity_method</code> (<code>simple</code> | <code>path</code>) - <code>simple</code>: Use proximity to bot location only - <code>path</code>: Use proximity to previous/next nodes in path (more realistic routing) - Default: <code>simple</code></p> <p><code>path_proximity_fallback</code> (boolean) - When path proximity can't be calculated, fall back to simple proximity - Default: <code>true</code></p> <p><code>max_proximity_range</code> (kilometers, 0 = disabled) - Maximum distance for geographic proximity consideration - Repeaters beyond this distance are filtered out or have reduced confidence - Default: <code>200</code> (long LoRa transmission range)</p> <p><code>recency_weight</code> (0.0 to 1.0) - Controls recency vs proximity weighting - <code>0.0</code> = 100% proximity (only distance matters) - <code>1.0</code> = 100% recency (only when last heard matters) - <code>0.4</code> = 40% recency, 60% proximity (balanced) - Default: <code>0.4</code></p> <p><code>recency_decay_half_life_hours</code> (hours) - How quickly recency scores decay for older repeaters - Default: <code>12</code> hours - For 48-72 hour advert intervals, use <code>36-48</code> hours</p> <p><code>max_repeater_age_days</code> (days, 0 = disabled) - Only include repeaters heard within this many days - Helps filter out stale repeaters - Default: <code>14</code> days</p>"},{"location":"path-command-config/#graph-based-selection","title":"Graph-Based Selection","text":"<p><code>graph_based_validation</code> (boolean) - Enable graph-based path validation using observed mesh connections - Default: <code>true</code></p> <p><code>min_edge_observations</code> (integer) - Minimum edge observations required for graph confidence - Higher values = more conservative (requires more evidence) - Default: <code>3</code></p> <p><code>graph_edge_expiration_days</code> (days) - Edges not observed for this many days are ignored - Default: <code>7</code> days</p> <p><code>graph_use_bidirectional</code> (boolean) - Check for reverse edges for higher confidence - Default: <code>true</code></p> <p><code>graph_use_hop_position</code> (boolean) - Validate candidates appear in expected positions based on observed routing patterns - Default: <code>true</code></p> <p><code>graph_multi_hop_enabled</code> (boolean) - Use 2-hop or 3-hop paths to find intermediate nodes when direct edges don't exist - Default: <code>true</code></p> <p><code>graph_multi_hop_max_hops</code> (integer) - Maximum hops for multi-hop path inference - <code>2</code> = only 2-hop paths (A-&gt;B-&gt;C) - <code>3</code> = also try 3-hop paths (A-&gt;B-&gt;C-&gt;D) - Default: <code>2</code></p> <p><code>graph_prefer_stored_keys</code> (boolean) - Prioritize candidates whose public key matches stored keys in graph edges - Stored keys indicate high confidence (+0.4 bonus) - Default: <code>true</code></p>"},{"location":"path-command-config/#graph-vs-geographic-selection","title":"Graph vs Geographic Selection","text":"<p><code>graph_geographic_combined</code> (boolean) - Combine graph and geographic scores into weighted average - Only combines when both methods select the same repeater - Default: <code>false</code> (uses graph-first fallback)</p> <p><code>graph_geographic_weight</code> (0.0 to 1.0) - Weight for graph score when combining (only used if <code>graph_geographic_combined = true</code>) - <code>0.7</code> = 70% graph, 30% geographic - Default: <code>0.7</code></p> <p><code>graph_confidence_override_threshold</code> (0.0 to 1.0) - When graph confidence &gt;= this value, graph overrides geographic selection - Lower values = geographic gets more consideration - <code>1.0</code> = always prefer geographic when available - <code>0.0</code> = always prefer graph - Default: <code>0.7</code></p>"},{"location":"path-command-config/#distance-penalties-intermediate-hops","title":"Distance Penalties (Intermediate Hops)","text":"<p><code>graph_distance_penalty_enabled</code> (boolean) - Penalize graph scores for candidates creating long-distance hops - Prevents selecting very distant repeaters even with strong graph evidence - Default: <code>true</code></p> <p><code>graph_max_reasonable_hop_distance_km</code> (kilometers) - Maximum reasonable hop distance before applying penalty - Typical LoRa transmission: &lt; 30km - Long LoRa transmission: up to 200km - Default: <code>30</code> (typical transmission range)</p> <p><code>graph_distance_penalty_strength</code> (0.0 to 1.0) - How much to penalize graph scores for long-distance hops - <code>0.3</code> = 30% penalty for hops beyond max_reasonable_hop_distance - Default: <code>0.3</code></p>"},{"location":"path-command-config/#zero-hop-bonus","title":"Zero-Hop Bonus","text":"<p><code>graph_zero_hop_bonus</code> (0.0 to 1.0) - Bonus for repeaters heard directly by the bot (zero-hop adverts) - Strong evidence the repeater is close, even for intermediate hops - Based on actual observed direct communication, not proximity guessing - Default: <code>0.4</code></p>"},{"location":"path-command-config/#final-hop-proximity-advanced","title":"Final Hop Proximity (Advanced)","text":"<p>The final hop (last repeater before bot) gets special proximity consideration. These settings are advanced and typically don't need adjustment.</p> <p><code>graph_final_hop_proximity_enabled</code> (boolean) - Enable bot location proximity consideration for final hop - Default: <code>true</code></p> <p><code>graph_final_hop_proximity_weight</code> (0.0 to 1.0) - Base weight for proximity when combining with graph score for final hop - <code>0.25</code> = 25% proximity, 75% graph score - Default: <code>0.25</code></p> <p><code>graph_final_hop_max_distance</code> (kilometers, 0 = no limit) - Maximum distance for final hop proximity consideration - Repeaters beyond this distance don't receive proximity bonus - Default: <code>0</code> (no limit)</p> <p><code>graph_final_hop_proximity_normalization_km</code> (kilometers) - Distance normalization for final hop proximity scoring - Lower values = more aggressive scoring - Default: <code>200</code> (long LoRa range)</p> <p><code>graph_final_hop_very_close_threshold_km</code> (kilometers) - Repeaters within this distance get 2x proximity weight boost - Default: <code>10</code> km</p> <p><code>graph_final_hop_close_threshold_km</code> (kilometers) - Repeaters within this distance get 1.5x proximity weight boost - Default: <code>30</code> km (typical transmission range)</p> <p><code>graph_final_hop_max_proximity_weight</code> (0.0 to 1.0) - Maximum proximity weight for very close repeaters - Default: <code>0.6</code></p>"},{"location":"path-command-config/#path-validation-bonus","title":"Path Validation Bonus","text":"<p><code>graph_path_validation_max_bonus</code> (0.0 to 1.0) - Maximum bonus for path validation matches - Helps resolve prefix collisions by matching stored path patterns - Default: <code>0.3</code></p> <p><code>graph_path_validation_obs_divisor</code> (float) - Divisor for observation count bonus - Lower values = stronger bonus from observation count - <code>50.0</code> means 50 observations = 0.15 bonus - Default: <code>50.0</code></p>"},{"location":"path-command-config/#graph-persistence-advanced","title":"Graph Persistence (Advanced)","text":"<p>These settings control how graph edges are stored in the database.</p> <p><code>graph_write_strategy</code> (<code>immediate</code> | <code>batched</code> | <code>hybrid</code>) - <code>immediate</code>: Write each edge update immediately (safer, higher I/O) - <code>batched</code>: Accumulate updates, flush periodically (better performance) - <code>hybrid</code>: Immediate for new edges, batched for increments (balanced) - Default: <code>hybrid</code></p> <p><code>graph_batch_interval_seconds</code> (seconds) - How often to flush pending edge updates (only for batched/hybrid) - Default: <code>30</code></p> <p><code>graph_batch_max_pending</code> (integer) - Maximum pending updates before forcing a flush - Default: <code>100</code></p> <p><code>graph_startup_load_days</code> (days, 0 = load all) - Load only edges seen in last N days on startup - <code>0</code> = load all edges (recommended for development) - Default: <code>0</code></p>"},{"location":"path-command-config/#preset-configurations","title":"Preset Configurations","text":""},{"location":"path-command-config/#balanced-default","title":"<code>balanced</code> (Default)","text":"<ul> <li>Uses both graph evidence and geographic proximity</li> <li>Graph confidence threshold: 0.7</li> <li>Distance penalties: enabled (30km threshold)</li> <li>Final hop proximity: enabled</li> <li>Good for: Most networks with mixed connectivity</li> </ul>"},{"location":"path-command-config/#geographic","title":"<code>geographic</code>","text":"<ul> <li>Prioritizes geographic proximity</li> <li>Graph confidence threshold: 0.5 (lower, gives geographic more weight)</li> <li>Distance penalties: enabled (30km threshold, stronger penalty)</li> <li>Final hop proximity: enabled with higher weight</li> <li>Good for: Local networks where repeaters are close together</li> </ul>"},{"location":"path-command-config/#graph","title":"<code>graph</code>","text":"<ul> <li>Prioritizes graph evidence</li> <li>Graph confidence threshold: 0.9 (higher, graph wins more often)</li> <li>Distance penalties: enabled (50km threshold, weaker penalty)</li> <li>Final hop proximity: enabled with lower weight</li> <li>Good for: Well-connected networks with strong graph evidence</li> </ul>"},{"location":"path-command-config/#typical-lora-transmission-ranges","title":"Typical LoRa Transmission Ranges","text":"<ul> <li>Typical transmission: &lt; 30km</li> <li>Long transmission: up to 200km</li> <li>Very close: &lt; 10km (often direct line-of-sight)</li> </ul> <p>These ranges inform the default distance thresholds used throughout the path selection algorithm.</p>"},{"location":"repeater-commands/","title":"Repeater Management DM Commands","text":"<p>This document provides comprehensive documentation for all repeater management commands available via direct message (DM) to the bot.</p> <p>Note: All repeater commands are DM-only and cannot be used in public channels.</p> <p>Command Format: <code>!repeater &lt;subcommand&gt; [options]</code></p>"},{"location":"repeater-commands/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Repeater Discovery &amp; Cataloging</li> <li>Listing &amp; Viewing</li> <li>Location &amp; Geolocation</li> <li>Purging Repeaters</li> <li>Restoring Repeaters</li> <li>Statistics &amp; Status</li> <li>Contact List Management</li> <li>Auto-Purge Management</li> <li>Testing &amp; Debugging</li> </ul>"},{"location":"repeater-commands/#repeater-discovery-cataloging","title":"Repeater Discovery &amp; Cataloging","text":""},{"location":"repeater-commands/#repeater-scan","title":"<code>!repeater scan</code>","text":"<p>Scans the current device contacts and catalogs new repeaters into the database. Also updates location data for existing repeaters.</p> <p>Usage: <pre><code>!repeater scan\n</code></pre></p> <p>What it does: - Scans all contacts on the device - Identifies repeaters and RoomServers - Catalogs new repeaters in the database - Updates location data for existing repeaters</p> <p>Example Response: <pre><code>\u2705 Scanned contacts and cataloged 5 new repeaters\n</code></pre></p>"},{"location":"repeater-commands/#repeater-discover","title":"<code>!repeater discover</code>","text":"<p>Discovers and adds companion contacts to the device.</p> <p>Usage: <pre><code>!repeater discover\n</code></pre></p> <p>What it does: - Scans for companion contacts that should be added to the device - Automatically adds discovered companions (if auto-add is enabled)</p> <p>Example Response: <pre><code>\u2705 Companion contact discovery initiated\n</code></pre></p>"},{"location":"repeater-commands/#listing-viewing","title":"Listing &amp; Viewing","text":""},{"location":"repeater-commands/#repeater-list","title":"<code>!repeater list</code>","text":"<p>Lists repeater contacts stored in the database.</p> <p>Usage: <pre><code>!repeater list          # Show active repeaters only\n!repeater list --all    # Show all repeaters (including purged)\n!repeater list -a       # Short form for --all\n</code></pre></p> <p>What it shows: - Repeater name - Device type (Repeater or RoomServer) - Last seen timestamp - Purge count - Active status (\ud83d\udfe2 active, \ud83d\udd34 purged)</p> <p>Example Response: <pre><code>\ud83d\udce1 **Repeater Contacts** (Active):\n\n\ud83d\udfe2 \ud83d\udce1 **Hillcrest**\n   Type: Repeater\n   Last seen: 2024-01-15 14:30\n   Purge count: 0\n\n\ud83d\udfe2 \ud83c\udfe0 **Northgate RoomServer**\n   Type: RoomServer\n   Last seen: 2024-01-15 12:00\n   Purge count: 1\n</code></pre></p>"},{"location":"repeater-commands/#location-geolocation","title":"Location &amp; Geolocation","text":""},{"location":"repeater-commands/#repeater-locations","title":"<code>!repeater locations</code>","text":"<p>Shows location data statistics for all tracked repeaters.</p> <p>Usage: <pre><code>!repeater locations\n</code></pre></p> <p>What it shows: - Total repeater count - Percentage with GPS coordinates - Percentage with city/state/country data - Examples of repeater locations</p> <p>Example Response: <pre><code>\ud83d\udccd Repeater Locations (25 total):\nGPS: 20 (80%)\nCity: 18 (72%)\nState: 15 (60%)\nCountry: 15 (60%)\nNone: 5 (20%)\n</code></pre></p> <p>(Second message with examples may follow)</p>"},{"location":"repeater-commands/#repeater-update-geo","title":"<code>!repeater update-geo</code>","text":"<p>Updates missing geolocation data (city, state, country) for repeaters that have coordinates but are missing location information.</p> <p>Usage: <pre><code>!repeater update-geo                    # Update up to 10 repeaters (default)\n!repeater update-geo 5                  # Update up to 5 repeaters\n!repeater update-geo dry-run            # Preview what would be updated\n!repeater update-geo dry-run 3           # Preview for up to 3 repeaters\n</code></pre></p> <p>What it does: - Finds repeaters with GPS coordinates but missing city/state/country - Performs reverse geocoding to fill in missing data - Respects rate limits (2 seconds between requests) - Skips repeaters with 0,0 coordinates (hidden locations)</p> <p>Example Response: <pre><code>\ud83c\udf0d Geolocation Update\nBatch size: 10\nFound: 8 repeaters with missing data\nUpdated: 6 repeaters\nErrors: 0\nSkipped: 2\n\u2705 Geolocation data updated successfully!\n</code></pre></p>"},{"location":"repeater-commands/#repeater-geocode","title":"<code>!repeater geocode</code>","text":"<p>Manages geocoding operations for contacts with coordinates but missing location data.</p> <p>Usage: <pre><code>!repeater geocode              # Show geocoding status\n!repeater geocode trigger       # Geocode 1 contact immediately\n!repeater geocode bulk         # Bulk geocode up to 10 contacts (default)\n!repeater geocode bulk 20      # Bulk geocode up to 20 contacts (max: 50)\n!repeater geocode dry-run      # Preview what would be geocoded\n!repeater geocode dry-run 5    # Preview for up to 5 contacts\n!repeater geocode status       # Show detailed geocoding status\n</code></pre></p> <p>Subcommands: - trigger - Manually trigger background geocoding for a single contact - bulk [N] - Bulk geocode multiple contacts (default: 10, max: 50) - dry-run [N] - Preview geocoding without making changes - status - Show detailed geocoding status</p> <p>Example Response (status): <pre><code>\ud83c\udf0d Geocoding: 45/60 done, 15 pending\n</code></pre></p> <p>Example Response (bulk): <pre><code>\ud83c\udf0d Bulk geocoding completed:\nFound: 15 contacts\nUpdated: 12 contacts\nErrors: 1\nSkipped: 2\n</code></pre></p>"},{"location":"repeater-commands/#purging-repeaters","title":"Purging Repeaters","text":""},{"location":"repeater-commands/#repeater-purge","title":"<code>!repeater purge</code>","text":"<p>Removes repeaters from the device contact list.</p> <p>Usage: <pre><code>!repeater purge all                    # Purge all repeaters\n!repeater purge all force               # Force purge all (uses multiple removal methods)\n!repeater purge all \"Clear all repeaters\"           # With reason\n!repeater purge 30                      # Purge repeaters older than 30 days\n!repeater purge 14 \"Auto-cleanup\"                   # Purge with reason\n!repeater purge \"Hillcrest\"             # Purge specific repeater by name\n!repeater purge \"Hillcrest\" \"Manual removal\"      # With reason\n</code></pre></p> <p>Options: - all - Remove all repeaters from device - all force - Force removal using multiple methods (for stubborn contacts) -  - Remove repeaters older than specified number of days -  - Remove specific repeater (partial name match allowed) <p>What it does: - Removes repeaters from the device contact list - Updates database to mark repeaters as purged - Records purge reason in database - Verifies removal was successful</p> <p>Example Response: <pre><code>\u2705 Purged 12/12 repeaters\n</code></pre></p> <p>If some fail: <pre><code>\u2705 Purged 10/12 repeaters\n\u274c Failed to purge 2 repeaters: Repeater1, Repeater2\n\ud83d\udca1 Try '!repeater purge all force' to force remove stubborn repeaters\n</code></pre></p>"},{"location":"repeater-commands/#repeater-auto-purge","title":"<code>!repeater auto-purge</code>","text":"<p>Manages automatic purging of repeaters when contact list approaches capacity limits.</p> <p>Usage: <pre><code>!repeater auto-purge                    # Show auto-purge status\n!repeater auto-purge trigger            # Manually trigger auto-purge check\n!repeater auto-purge enable             # Enable automatic purging\n!repeater auto-purge disable            # Disable automatic purging\n!repeater auto-purge monitor            # Run periodic contact monitoring\n</code></pre></p> <p>Subcommands: - trigger - Manually trigger an auto-purge check and execution - enable - Enable automatic purging - disable - Disable automatic purging - monitor - Run periodic contact monitoring (checks limits and triggers background geocoding)</p> <p>Example Response (status): <pre><code>\ud83d\udd04 Auto-Purge: ON | 285/300 (95%) | \u26a0\ufe0f NEAR LIMIT\n</code></pre></p> <p>Example Response (trigger): <pre><code>\u2705 Auto-purge triggered successfully\n</code></pre></p>"},{"location":"repeater-commands/#repeater-purge-status","title":"<code>!repeater purge-status</code>","text":"<p>Shows detailed purge status and recommendations.</p> <p>Usage: <pre><code>!repeater purge-status\n</code></pre></p> <p>What it shows: - Auto-purge enabled/disabled status - Current contact count vs limit - Usage percentage - Health status (OK, NEAR LIMIT, FULL)</p> <p>Example Response: <pre><code>\ud83d\udcca Purge: ON | 285/300 (95%) | \u26a0\ufe0f Near 280\n</code></pre></p>"},{"location":"repeater-commands/#restoring-repeaters","title":"Restoring Repeaters","text":""},{"location":"repeater-commands/#repeater-restore","title":"<code>!repeater restore</code>","text":"<p>Restores a previously purged repeater (marks it as active in database, but does not re-add to device).</p> <p>Usage: <pre><code>!repeater restore \"Hillcrest\"                    # Restore by name\n!repeater restore \"Hillcrest\" \"Manual restore\"   # With reason\n</code></pre></p> <p>What it does: - Finds purged repeaters matching the name pattern - Marks them as active in the database - Records restore reason - Does NOT automatically re-add to device contact list</p> <p>Example Response: <pre><code>\u2705 Restored repeater: Hillcrest\n</code></pre></p> <p>If multiple matches: <pre><code>Multiple purged repeaters found matching 'Hill':\n1. Hillcrest (Repeater)\n2. Hilltop (RoomServer)\n\nPlease be more specific with the name.\n</code></pre></p>"},{"location":"repeater-commands/#statistics-status","title":"Statistics &amp; Status","text":""},{"location":"repeater-commands/#repeater-stats","title":"<code>!repeater stats</code>","text":"<p>Shows comprehensive statistics about repeater tracking and management.</p> <p>Usage: <pre><code>!repeater stats\n</code></pre></p> <p>What it shows: - Total contacts ever heard - Currently tracked by device - Recent activity (24 hours) - Breakdown by MeshCore role (repeater, roomserver, companion, etc.) - Breakdown by device type</p> <p>Example Response: <pre><code>\ud83d\udcca **Contact Tracking Statistics:**\n\n\u2022 **Total Contacts Ever Heard:** 150\n\u2022 **Currently Tracked by Device:** 45\n\u2022 **Recent Activity (24h):** 12\n\n**By MeshCore Role:**\n\u2022 Repeater: 25\n\u2022 RoomServer: 8\n\u2022 Companion: 10\n\u2022 Sensor: 2\n\n**By Device Type:**\n\u2022 Repeater: 25\n\u2022 RoomServer: 8\n\u2022 Companion: 10\n</code></pre></p>"},{"location":"repeater-commands/#repeater-status","title":"<code>!repeater status</code>","text":"<p>Shows contact list capacity status and limits.</p> <p>Usage: <pre><code>!repeater status\n</code></pre></p> <p>What it shows: - Current contacts vs estimated limit - Usage percentage - Companion count - Repeater count - Stale contacts count - Health status indicator</p> <p>Example Response: <pre><code>\ud83d\udcca 285/300 (95%) | \ud83d\udc6510 \ud83d\udce125 \u23f05 | \u26a0\ufe0f NEAR\n</code></pre></p> <p>Status Indicators: - \u2705 OK - Healthy usage - \u26a0\ufe0f NEAR - Approaching limit - \ud83d\udea8 FULL! - At or over limit</p>"},{"location":"repeater-commands/#contact-list-management","title":"Contact List Management","text":""},{"location":"repeater-commands/#repeater-manage","title":"<code>!repeater manage</code>","text":"<p>Automatically manages the contact list to prevent hitting capacity limits.</p> <p>Usage: <pre><code>!repeater manage                    # Perform automatic management\n!repeater manage --dry-run          # Preview what would be done\n!repeater manage -d                 # Short form for --dry-run\n</code></pre></p> <p>What it does: - Analyzes contact list capacity - Removes stale contacts - Removes old repeaters (14+ days) - If at limit, performs aggressive cleanup (7+ day repeaters, 14+ day stale contacts) - Shows what actions were taken</p> <p>Example Response (dry-run): <pre><code>\ud83d\udd0d **Contact List Management (Dry Run)**\n\n\ud83d\udcca Current status: 285/300 (95.0%)\n\n\u26a0\ufe0f **Actions that would be taken:**\n   \u2022 Remove 10 stale contacts\n   \u2022 Remove old repeaters (14+ days)\n</code></pre></p> <p>Example Response (executed): <pre><code>\ud83d\udd27 **Contact List Management Results**\n\n\ud83d\udcca Final status: 270/300 (90.0%)\n\n\u2705 **Actions taken:**\n   \u2022 Removed 10 stale contacts\n   \u2022 Removed 5 old repeaters (14+ days)\n</code></pre></p>"},{"location":"repeater-commands/#repeater-add","title":"<code>!repeater add</code>","text":"<p>Adds a discovered contact to the device contact list.</p> <p>Usage: <pre><code>!repeater add \"ContactName\"                    # Add by name\n!repeater add \"ContactName\" &lt;public_key&gt;       # Add with public key\n!repeater add \"John\" \"0x1234...\" \"Manual add\"   # With reason\n</code></pre></p> <p>What it does: - Adds the specified contact to the device - Can optionally specify public key - Records addition reason</p> <p>Example Response: <pre><code>\u2705 Successfully added contact: John\n</code></pre></p>"},{"location":"repeater-commands/#repeater-auto","title":"<code>!repeater auto</code>","text":"<p>Toggles manual contact addition setting.</p> <p>Usage: <pre><code>!repeater auto on                    # Enable auto-add\n!repeater auto off                   # Disable auto-add\n!repeater auto enable                # Enable (alternative)\n!repeater auto disable               # Disable (alternative)\n</code></pre></p> <p>What it does: - Controls whether contacts are automatically added when discovered - When OFF: Bot requires manual addition via <code>!repeater add</code> - When ON: Bot automatically adds discovered contacts</p> <p>Example Response: <pre><code>\u2705 Manual contact addition disabled\n</code></pre></p>"},{"location":"repeater-commands/#testing-debugging","title":"Testing &amp; Debugging","text":""},{"location":"repeater-commands/#repeater-test","title":"<code>!repeater test</code>","text":"<p>Tests meshcore-cli command functionality.</p> <p>Usage: <pre><code>!repeater test\n</code></pre></p> <p>What it does: - Tests if meshcore-cli commands are available - Verifies help command works - Verifies remove_contact command works - Reports if purging functionality will work</p> <p>Example Response: <pre><code>\ud83e\uddea **MeshCore-CLI Command Test Results**\n\n\ud83d\udccb Help command: \u2705 PASS\n\ud83d\uddd1\ufe0f Remove contact command: \u2705 PASS\n\n\u2705 All required commands are available.\n</code></pre></p> <p>If commands are missing: <pre><code>\ud83e\uddea **MeshCore-CLI Command Test Results**\n\n\ud83d\udccb Help command: \u2705 PASS\n\ud83d\uddd1\ufe0f Remove contact command: \u274c FAIL\n\n\u26a0\ufe0f **WARNING**: remove_contact command not available!\nThis means repeater purging will not work properly.\nCheck your meshcore-cli installation and device connection.\n</code></pre></p>"},{"location":"repeater-commands/#repeater-test-purge","title":"<code>!repeater test-purge</code>","text":"<p>Tests the improved purge system.</p> <p>Usage: <pre><code>!repeater test-purge\n</code></pre></p> <p>What it does: - Performs a test purge operation - Shows initial and final contact counts - Reports which purge method was used - Verifies the purge system is working</p> <p>Example Response: <pre><code>\ud83e\uddea Test: TestContact | 50\u219249 (-1) | contact_key | \u2705 OK\n</code></pre></p>"},{"location":"repeater-commands/#repeater-debug-purge","title":"<code>!repeater debug-purge</code>","text":"<p>Debugs the purge system to see what repeaters are available.</p> <p>Usage: <pre><code>!repeater debug-purge\n</code></pre></p> <p>What it shows: - Total contacts on device - Number of repeaters found - List of repeaters with their types - Test of purge selection logic</p> <p>Example Response: <pre><code>\ud83d\udd0d Debug: 50 total, 12 repeaters | \u2022 Hillcrest (Repeater)... | \u2022 Northgate (RoomServer)... | Test: 3 available\n</code></pre></p>"},{"location":"repeater-commands/#help","title":"Help","text":""},{"location":"repeater-commands/#repeater-help","title":"<code>!repeater help</code>","text":"<p>Shows comprehensive help for all repeater commands.</p> <p>Usage: <pre><code>!repeater help\n</code></pre></p>"},{"location":"repeater-commands/#configuration","title":"Configuration","text":"<p>The repeater management system respects several configuration settings in <code>config.ini</code>:</p> <ul> <li><code>auto_manage_contacts</code> - Controls automatic contact management</li> <li><code>device</code> - Device handles auto-addition, bot manages capacity</li> <li><code>bot</code> - Bot automatically adds companion contacts and manages capacity</li> <li> <p><code>false</code> - Manual mode (use commands to manage contacts)</p> </li> <li> <p>Auto-purge threshold and limits are configured in the repeater manager</p> </li> </ul>"},{"location":"repeater-commands/#notes","title":"Notes","text":"<ol> <li>DM Only: All repeater commands are DM-only for security reasons</li> <li>Rate Limiting: Geolocation commands respect rate limits (2 seconds between requests)</li> <li>Database Tracking: All actions are logged in the database with reasons</li> <li>Verification: Purge operations verify successful removal</li> <li>Background Tasks: Some operations (like background geocoding) run asynchronously</li> <li>Multi-Message Responses: Some commands (like <code>locations</code>) may send multiple messages to stay within message size limits</li> </ol>"},{"location":"repeater-commands/#common-use-cases","title":"Common Use Cases","text":""},{"location":"repeater-commands/#initial-setup","title":"Initial Setup","text":"<pre><code>!repeater scan                    # Catalog existing repeaters\n!repeater status                  # Check contact list capacity\n</code></pre>"},{"location":"repeater-commands/#regular-maintenance","title":"Regular Maintenance","text":"<pre><code>!repeater status                  # Check capacity\n!repeater manage                  # Auto-manage if needed\n!repeater update-geo              # Fill in missing location data\n</code></pre>"},{"location":"repeater-commands/#emergency-cleanup","title":"Emergency Cleanup","text":"<pre><code>!repeater status                  # Check if at limit\n!repeater purge-status            # Detailed status\n!repeater auto-purge trigger      # Trigger auto-purge\n</code></pre>"},{"location":"repeater-commands/#bulk-operations","title":"Bulk Operations","text":"<pre><code>!repeater purge 30                # Remove old repeaters\n!repeater update-geo 20           # Geocode 20 repeaters\n!repeater geocode bulk 25         # Bulk geocode 25 contacts\n</code></pre>"},{"location":"repeater-commands/#error-messages","title":"Error Messages","text":"<p>Common error messages and their meanings:</p> <ul> <li><code>Repeater manager not initialized</code> - Bot configuration issue, check logs</li> <li><code>No repeaters found</code> - No repeaters match your criteria</li> <li><code>Failed to purge</code> - Contact removal failed (try <code>force</code> option)</li> <li><code>No network connectivity</code> - Cannot reach geocoding service</li> <li><code>Rate limited</code> - Too many geocoding requests (wait and retry)</li> </ul>"},{"location":"repeater-commands/#see-also","title":"See Also","text":"<ul> <li><code>REPEATER_MANAGEMENT.md</code> - Technical details about repeater management system</li> <li>Bot configuration file (<code>config.ini</code>) - Configuration options</li> </ul>"},{"location":"service-plugins/","title":"Service Plugins","text":"<p>Service plugins extend the bot with background services that run alongside the main message loop. Each can be enabled or disabled in <code>config.ini</code>.</p> Plugin Description Discord Bridge One-way webhook bridge to post mesh messages to Discord channels Packet Capture Capture packets from the mesh and publish them to MQTT brokers Map Uploader Upload node advertisements to map.meshcore.dev for network visualization Weather Service Scheduled weather forecasts, weather alerts, and lightning detection"},{"location":"service-plugins/#enabling-a-plugin","title":"Enabling a plugin","text":"<ol> <li>Add or edit the plugin's section in <code>config.ini</code> (see each plugin's doc for options).</li> <li>Set <code>enabled = true</code> for that plugin.</li> <li>Restart the bot.</li> </ol> <p>Some plugins require additional configuration (API keys, webhook URLs, etc.) before they will run successfully.</p>"},{"location":"upgrade/","title":"Upgrade Guide","text":"<p>This document describes changes that may affect users upgrading from previous versions.</p>"},{"location":"upgrade/#upgrading-from-v07","title":"Upgrading from v0.7","text":""},{"location":"upgrade/#config-compatibility","title":"Config Compatibility","text":"<p>Previous config files continue to work. The following legacy config formats are supported:</p> <ul> <li><code>[Jokes]</code> with <code>joke_enabled</code> / <code>dadjoke_enabled</code> \u2014 Migrated to <code>[Joke_Command]</code> and <code>[DadJoke_Command]</code> with <code>enabled</code>. Both formats work; consider updating to the new format.</li> <li><code>[Stats]</code> / <code>stats_enabled</code>, <code>[Sports]</code> / <code>sports_enabled</code>, <code>[Hacker]</code> / <code>hacker_enabled</code>, <code>[Alert_Command]</code> / <code>alert_enabled</code> \u2014 All support the legacy <code>*_enabled</code> key; the new <code>enabled</code> key is preferred.</li> </ul>"},{"location":"upgrade/#banned-users-prefix-matching","title":"Banned Users: Prefix Matching","text":"<p><code>[Banned_Users]</code> uses prefix (starts-with) matching for <code>banned_users</code> entries. A banned entry <code>\"Awful Username\"</code> matches both <code>\"Awful Username\"</code> and <code>\"Awful Username \ud83c\udf46\"</code>. If you rely on exact matching, ensure your banned entries are specific enough.</p>"},{"location":"upgrade/#new-optional-sections","title":"New Optional Sections","text":"<ul> <li><code>[Feed_Manager]</code> \u2014 If you use RSS/API feeds, add this section. If absent, the feed manager is disabled. New installs and minimal configs include <code>[Feed_Manager]</code> with <code>feed_manager_enabled = false</code>.</li> <li><code>[Path_Command]</code> \u2014 New options like <code>path_selection_preset</code>, <code>enable_p_shortcut</code> (default: true), and graph-related settings. Omitted options use sensible defaults.</li> </ul>"},{"location":"weather-service/","title":"Weather Service","text":"<p>Provides scheduled weather forecasts, weather alerts, and lightning detection.</p>"},{"location":"weather-service/#quick-start","title":"Quick Start","text":"<ol> <li>Configure Bot - Edit <code>config.ini</code>:</li> </ol> <pre><code>[Weather_Service]\nenabled = true\n\n# Your location (required)\nmy_position_lat = 47.6062\nmy_position_lon = -122.3321\n\n# Daily forecast time\nweather_alarm = 6:00              # Or \"sunrise\" / \"sunset\"\n\n# Channels\nweather_channel = #weather\nalerts_channel = #weather\n</code></pre> <ol> <li>Restart Bot - Daily forecasts start automatically</li> </ol>"},{"location":"weather-service/#configuration","title":"Configuration","text":""},{"location":"weather-service/#basic-settings","title":"Basic Settings","text":"<pre><code>[Weather_Service]\nenabled = true\nmy_position_lat = 47.6062         # Your latitude (required)\nmy_position_lon = -122.3321       # Your longitude (required)\nweather_alarm = 6:00              # Time for daily forecast (HH:MM or sunrise/sunset)\nweather_channel = #weather        # Channel for forecasts\nalerts_channel = #weather         # Channel for weather alerts\n</code></pre>"},{"location":"weather-service/#alert-polling","title":"Alert Polling","text":"<pre><code>poll_weather_alerts_interval = 600000  # Check for alerts every 10 minutes (milliseconds)\n</code></pre>"},{"location":"weather-service/#lightning-detection-optional","title":"Lightning Detection (Optional)","text":"<p>Requires <code>paho-mqtt</code> library.</p> <pre><code>blitz_collection_interval = 600000     # Aggregate lightning every 10 minutes\n\n# Define detection area (optional)\nblitz_area_min_lat = 47.0\nblitz_area_min_lon = -123.0\nblitz_area_max_lat = 48.0\nblitz_area_max_lon = -121.0\n</code></pre>"},{"location":"weather-service/#features","title":"Features","text":""},{"location":"weather-service/#daily-weather-forecast","title":"Daily Weather Forecast","text":"<p>Sends forecast to <code>weather_channel</code> at configured time:</p> <p>Example Output: <pre><code>\ud83c\udf24\ufe0f Daily Weather: Seattle: \u2600\ufe0fClear 68\u00b0F NNE8mph | Tomorrow: \ud83c\udf27\ufe0fLight Rain 55-72\u00b0F\n</code></pre></p> <p>Data Includes: - Current conditions with emoji - Temperature - Wind speed and direction - Tomorrow's forecast</p> <p>Scheduling Options: - Fixed time: <code>weather_alarm = 6:00</code> (24-hour format) - Sunrise: <code>weather_alarm = sunrise</code> - Sunset: <code>weather_alarm = sunset</code></p>"},{"location":"weather-service/#weather-alerts-us-only","title":"Weather Alerts (US Only)","text":"<p>Monitors NOAA weather alerts and posts new alerts to <code>alerts_channel</code>:</p> <p>Example Output: <pre><code>\ud83d\udfe1Wind Adv Seattle til 9PM by NWS SEA https://is.gd/abc123\n</code></pre></p> <p>Alert Types: - Warnings (tornado, severe thunderstorm, etc.) - Watches (winter storm, flood, etc.) - Advisories (wind, fog, etc.) - Statements (special weather)</p> <p>Compact Format: - Severity emoji (\ud83d\udd34\ud83d\udfe0\ud83d\udfe1\u26aa) - Event type and location - Expiration time - Issuing office - Shortened URL for details</p>"},{"location":"weather-service/#lightning-detection-optional_1","title":"Lightning Detection (Optional)","text":"<p>Monitors real-time lightning strikes via Blitzortung MQTT:</p> <p>Example Output: <pre><code>\ud83c\udf29\ufe0f Bellevue (15km NE)\n</code></pre></p> <p>How It Works: 1. Connects to Blitzortung MQTT broker 2. Filters strikes within configured <code>blitz_area</code> 3. Aggregates strikes every <code>blitz_collection_interval</code> 4. Reports areas with 10+ strikes</p>"},{"location":"weather-service/#weather-data-source","title":"Weather Data Source","text":"<p>Uses Open-Meteo API (free, no API key required).</p> <p>Temperature Units: Inherited from <code>[Weather]</code> section (see Weather command docs): <pre><code>[Weather]\ntemperature_unit = fahrenheit     # fahrenheit or celsius\nwind_speed_unit = mph             # mph, ms, kn\nprecipitation_unit = inch         # inch or mm\n</code></pre></p>"},{"location":"weather-service/#alerts-us-only","title":"Alerts (US Only)","text":"<p>Weather alerts use NOAA API which is US-only. For other countries: - Daily forecasts work worldwide via Open-Meteo - Weather alerts won't be available - Lightning detection works worldwide via Blitzortung</p>"},{"location":"weather-service/#troubleshooting","title":"Troubleshooting","text":""},{"location":"weather-service/#service-not-starting","title":"Service Not Starting","text":"<p>Check logs: <pre><code>tail -f meshcore_bot.log | grep WeatherService\n</code></pre></p> <p>Common issues: - Missing <code>my_position_lat</code> or <code>my_position_lon</code> - Invalid coordinates - <code>enabled = false</code></p>"},{"location":"weather-service/#no-daily-forecasts","title":"No Daily Forecasts","text":"<ol> <li>Check alarm time - Service logs \"Next forecast at HH:MM:SS\"</li> <li>Check channel - Verify <code>weather_channel</code> exists</li> <li>Check position - Coordinates must be valid</li> </ol>"},{"location":"weather-service/#no-weather-alerts","title":"No Weather Alerts","text":"<ol> <li>US only - NOAA alerts only work in the United States</li> <li>Check polling - Service logs \"Starting weather alerts polling\"</li> <li>New alerts only - Only alerts issued since last check are sent</li> </ol>"},{"location":"weather-service/#lightning-not-working","title":"Lightning Not Working","text":"<ol> <li>Check dependencies: <code>pip install paho-mqtt</code></li> <li>Check area config - All 4 coordinates required (min/max lat/lon)</li> <li>Check MQTT connection - Service logs \"Connected to Blitzortung MQTT\"</li> </ol>"},{"location":"weather-service/#advanced","title":"Advanced","text":""},{"location":"weather-service/#sunrisesunset-forecasts","title":"Sunrise/Sunset Forecasts","text":"<p>When using <code>weather_alarm = sunrise</code> or <code>sunset</code>: - Calculates time based on your coordinates - Updates daily for seasonal changes - Uses local timezone automatically</p>"},{"location":"weather-service/#alert-deduplication","title":"Alert Deduplication","text":"<p>Alerts are tracked by ID to prevent duplicates. The service maintains a list of seen alert IDs and only sends new alerts.</p>"},{"location":"weather-service/#lightning-strike-bucketing","title":"Lightning Strike Bucketing","text":"<p>Strikes are grouped by: - Direction (heading from your location) - Distance (grouped in 10km buckets)</p> <p>Example: All strikes 50-60km to the NE are counted as one area.</p>"},{"location":"weather-service/#faq","title":"FAQ","text":"<p>Q: Do I need an API key? A: No. Open-Meteo is free and doesn't require an API key.</p> <p>Q: Can I get alerts for other countries? A: Daily forecasts work worldwide. Weather alerts are currently US-only (NOAA). If you would like added, let me know.</p> <p>Q: How accurate are the forecasts? A: Open-Meteo uses data from national weather services (NOAA, DWD, etc.). Accuracy varies by location.</p> <p>Q: Can I change temperature units? A: Yes, set <code>temperature_unit</code> in the <code>[Weather]</code> section (used by wx command too).</p> <p>Q: Does lightning detection work worldwide? A: Yes. Blitzortung has global coverage.</p> <p>Q: Why do I need to define a lightning detection area? A: To filter strikes. Without an area, you'd get alerts for the entire globe.</p>"},{"location":"web-viewer/","title":"MeshCore Bot Data Viewer","text":"<p>A web-based interface for viewing and analyzing data from your MeshCore Bot.</p>"},{"location":"web-viewer/#features","title":"Features","text":"<ul> <li>Dashboard: Overview of database statistics and bot status</li> <li>Repeater Contacts: View active repeater contacts with location and status information</li> <li>Contact Tracking: Complete history of all heard contacts with signal strength and routing data</li> <li>Cache Data: View cached geocoding and API responses</li> <li>Purging Log: Audit trail of contact purging operations</li> <li>Real-time Updates: Auto-refreshes every 30 seconds</li> <li>API Endpoints: JSON API for programmatic access</li> </ul>"},{"location":"web-viewer/#quick-start","title":"Quick Start","text":""},{"location":"web-viewer/#option-1-standalone-mode","title":"Option 1: Standalone Mode","text":"<pre><code># Install Flask if not already installed\npip3 install flask\n\n# Start the web viewer (reads config from config.ini)\npython3 -m modules.web_viewer.app\n\n# Or use the restart script for standalone mode\n./restart_viewer.sh\n\n# Override configuration with command line arguments\npython3 -m modules.web_viewer.app --port 8080 --host 0.0.0.0\n</code></pre>"},{"location":"web-viewer/#option-2-integrated-with-bot","title":"Option 2: Integrated with Bot","text":"<ol> <li> <p>Edit <code>config.ini</code> and set:    <pre><code>[Web_Viewer]\nenabled = true\nauto_start = true\nhost = 127.0.0.1\nport = 5000\n</code></pre></p> </li> <li> <p>The web viewer will start automatically with the bot</p> </li> </ol>"},{"location":"web-viewer/#configuration","title":"Configuration","text":"<p>The web viewer can be configured in the <code>[Web_Viewer]</code> section of <code>config.ini</code>:</p> <pre><code>[Web_Viewer]\n# Enable or disable the web data viewer\nenabled = true\n\n# Web viewer host address\n# 127.0.0.1: Only accessible from localhost\n# 0.0.0.0: Accessible from any network interface\nhost = 127.0.0.1\n\n# Web viewer port\nport = 5000\n\n# Enable debug mode for the web viewer\ndebug = false\n\n# Auto-start web viewer with bot\nauto_start = false\n</code></pre>"},{"location":"web-viewer/#accessing-the-viewer","title":"Accessing the Viewer","text":"<p>Once started, open your web browser and navigate to: - Local access: http://localhost:5005 (or your configured port) - Network access: http://YOUR_BOT_IP:5005 (if host is set to 0.0.0.0)</p>"},{"location":"web-viewer/#pages-overview","title":"Pages Overview","text":""},{"location":"web-viewer/#dashboard","title":"Dashboard","text":"<ul> <li>Database status and statistics</li> <li>Contact counts and cache information</li> <li>Quick navigation to other sections</li> </ul>"},{"location":"web-viewer/#repeater-contacts","title":"Repeater Contacts","text":"<ul> <li>Active repeater contacts</li> <li>Location information (city/coordinates)</li> <li>Device types and status</li> <li>First/last seen timestamps</li> <li>Purge count tracking</li> </ul>"},{"location":"web-viewer/#contact-tracking","title":"Contact Tracking","text":"<ul> <li>Complete history of all heard contacts</li> <li>Signal strength indicators</li> <li>Hop count and routing information</li> <li>Advertisement data</li> <li>Currently tracked status</li> </ul>"},{"location":"web-viewer/#cache-data","title":"Cache Data","text":"<ul> <li>Geocoding cache entries</li> <li>Generic cache entries (weather, sports, etc.)</li> <li>Expiration status</li> <li>Cache value previews</li> </ul>"},{"location":"web-viewer/#purging-log","title":"Purging Log","text":"<ul> <li>Audit trail of contact purging operations</li> <li>Timestamps and reasons</li> <li>Contact names and public keys</li> </ul>"},{"location":"web-viewer/#api-endpoints","title":"API Endpoints","text":"<p>The viewer also provides JSON API endpoints:</p> <ul> <li><code>GET /api/stats</code> - Database statistics</li> <li><code>GET /api/contacts</code> - Repeater contacts data</li> <li><code>GET /api/tracking</code> - Contact tracking data</li> </ul> <p>Example usage: <pre><code>curl http://localhost:5000/api/stats\n</code></pre></p>"},{"location":"web-viewer/#database-requirements","title":"Database Requirements","text":"<p>The viewer uses the same database as the bot by default (<code>[Bot] db_path</code>, typically <code>meshcore_bot.db</code>). That single file holds repeater contacts, mesh graph, packet stream, and other data so the viewer can show everything.</p>"},{"location":"web-viewer/#migrating-from-a-separate-web-viewer-database","title":"Migrating from a separate web viewer database","text":"<p>If you previously had the web viewer using a separate database (e.g. <code>[Web_Viewer] db_path = bot_data.db</code>), you can switch to the shared database so the viewer shows repeater/graph data and uses one file.</p> <ol> <li> <p>Stop the bot and web viewer so neither has the databases open.</p> </li> <li> <p>Optionally preserve packet stream history from the old viewer DB into the main DB:</p> </li> <li>From the project root, run:      <pre><code>python3 migrate_webviewer_db.py bot_data.db meshcore_bot.db\n</code></pre>      Use your actual paths if they differ (e.g. full paths or different filenames). The script copies the <code>packet_stream</code> table from the first file into the second and skips rows that would duplicate IDs.</li> <li> <p>If you don\u2019t care about old packet stream data, skip this step; the viewer will create a new <code>packet_stream</code> table in the main DB.</p> </li> <li> <p>Point the viewer at the main database in <code>config.ini</code>:    <pre><code>[Web_Viewer]\ndb_path = meshcore_bot.db\n</code></pre>    (Or the same value as <code>[Bot] db_path</code> if you use a different path.)</p> </li> <li> <p>Start the bot (and viewer as usual). The viewer will now read and write to the same database as the bot.</p> </li> </ol> <p>You can keep or remove the old <code>bot_data.db</code> file after verifying the viewer works with the shared DB.</p>"},{"location":"web-viewer/#troubleshooting","title":"Troubleshooting","text":""},{"location":"web-viewer/#flask-not-found","title":"Flask Not Found","text":"<pre><code>pip3 install flask\n</code></pre>"},{"location":"web-viewer/#database-not-found","title":"Database Not Found","text":"<ul> <li>Ensure the bot has been run at least once to create the databases</li> <li>Check file permissions on database files</li> </ul>"},{"location":"web-viewer/#port-already-in-use","title":"Port Already in Use","text":"<ul> <li>Change the port in <code>config.ini</code> or stop the conflicting service</li> <li>Use <code>lsof -i :5000</code> to find what's using the port</li> </ul>"},{"location":"web-viewer/#permission-denied","title":"Permission Denied","text":"<pre><code>chmod +x restart_viewer.sh\n</code></pre>"},{"location":"web-viewer/#security-notes","title":"Security Notes","text":"<ul> <li>The web viewer is designed for local network use</li> <li>Set <code>host = 127.0.0.1</code> for localhost-only access</li> <li>Set <code>host = 0.0.0.0</code> for network access (use with caution)</li> <li>No authentication is implemented - consider firewall rules for production use</li> </ul>"},{"location":"web-viewer/#future-enhancements","title":"Future Enhancements","text":"<ul> <li>Live packet streaming</li> <li>Real-time message monitoring</li> <li>Interactive contact management</li> <li>Export functionality</li> <li>Authentication system</li> <li>Mobile-responsive design improvements</li> </ul>"}]}